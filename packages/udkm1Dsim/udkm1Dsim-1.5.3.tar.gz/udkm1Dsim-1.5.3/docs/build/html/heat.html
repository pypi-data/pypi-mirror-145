

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>simulations.heat &mdash; udkm1Dsim 1.4.5 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="simulations.phonons" href="phonons.html" />
    <link rel="prev" title="simulations.simulation" href="simulation.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> udkm1Dsim
          

          
          </a>

          
            
            
              <div class="version">
                1.4.5
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference external" href="https://github.com/dschick/udkm1Dsim">Project Page</a></li>
<li class="toctree-l1"><a class="reference external" href="http://pypi.python.org/pypi/udkm1Dsim">Download from PyPI</a></li>
<li class="toctree-l1"><a class="reference internal" href="user_guide.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="examples/structure.html">Structure</a><ul>
<li class="toctree-l3"><a class="reference internal" href="examples/structure.html#Setup">Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/structure.html#Atoms">Atoms</a><ul>
<li class="toctree-l4"><a class="reference internal" href="examples/structure.html#Atom">Atom</a></li>
<li class="toctree-l4"><a class="reference internal" href="examples/structure.html#Mixed-Atom">Mixed Atom</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="examples/structure.html#Layers">Layers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="examples/structure.html#Amorphous-Layers">Amorphous Layers</a></li>
<li class="toctree-l4"><a class="reference internal" href="examples/structure.html#Unit-Cells">Unit Cells</a><ul>
<li class="toctree-l5"><a class="reference internal" href="examples/structure.html#Non-Linear-Strain-Dependence">Non-Linear Strain Dependence</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="examples/structure.html#id1">Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/structure.html#Static-Substrate">Static Substrate</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="examples/heat.html">Heat</a><ul>
<li class="toctree-l3"><a class="reference internal" href="examples/heat.html#Setup">Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/heat.html#Structure">Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/heat.html#Initialize-Heat">Initialize Heat</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/heat.html#Simple-Excitation">Simple Excitation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="examples/heat.html#Laser-Absorption-Profile">Laser Absorption Profile</a></li>
<li class="toctree-l4"><a class="reference internal" href="examples/heat.html#Temperature-Map">Temperature Map</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="examples/heat.html#Heat-Diffusion">Heat Diffusion</a><ul>
<li class="toctree-l4"><a class="reference internal" href="examples/heat.html#Heat-Diffusion-Parameters">Heat Diffusion Parameters</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="examples/heat.html#Multipulse-Excitation">Multipulse Excitation</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/heat.html#N-Temperature-Model"><span class="math notranslate nohighlight">\(N\)</span>-Temperature Model</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="examples/m3tm.html">Microscopic 3-Temperature-Model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="examples/m3tm.html#Setup">Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/m3tm.html#Structure">Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/m3tm.html#Initialize-Heat-and-the-Excitation">Initialize Heat and the Excitation</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/m3tm.html#Calculate-Heat-Diffusion">Calculate Heat Diffusion</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="examples/phonons.html">Phonons</a><ul>
<li class="toctree-l3"><a class="reference internal" href="examples/phonons.html#Setup">Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/phonons.html#Structure">Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/phonons.html#Heat">Heat</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/phonons.html#Analytical-Phonons">Analytical Phonons</a><ul>
<li class="toctree-l4"><a class="reference internal" href="examples/phonons.html#Energy-Spectrum">Energy Spectrum</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="examples/phonons.html#Numerical-Phonons">Numerical Phonons</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/phonons.html#Anharmonic-Phonon-Propagation">Anharmonic Phonon Propagation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="examples/dynamical_xray.html">Dynamical Xray Scattering</a><ul>
<li class="toctree-l3"><a class="reference internal" href="examples/dynamical_xray.html#Setup">Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/dynamical_xray.html#Structure">Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/dynamical_xray.html#Heat">Heat</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/dynamical_xray.html#Numerical-Phonons">Numerical Phonons</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/dynamical_xray.html#Initialize-dynamical-X-ray-simulation">Initialize dynamical X-ray simulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/dynamical_xray.html#Homogeneous-X-ray-scattering">Homogeneous X-ray scattering</a><ul>
<li class="toctree-l4"><a class="reference internal" href="examples/dynamical_xray.html#q_z-scan"><span class="math notranslate nohighlight">\(q_z\)</span>-scan</a></li>
<li class="toctree-l4"><a class="reference internal" href="examples/dynamical_xray.html#Post-Processing">Post-Processing</a></li>
<li class="toctree-l4"><a class="reference internal" href="examples/dynamical_xray.html#Energy-scan">Energy-scan</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="examples/dynamical_xray.html#Inhomogeneous-X-ray-scattering">Inhomogeneous X-ray scattering</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/dynamical_xray.html#Parallel-inhomogeneous-X-ray-scattering">Parallel inhomogeneous X-ray scattering</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="examples/dynamical_magnetic_xray.html">Dynamical Magnetic Xray Scattering</a><ul>
<li class="toctree-l3"><a class="reference internal" href="examples/dynamical_magnetic_xray.html#Setup">Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/dynamical_magnetic_xray.html#Structure">Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/dynamical_magnetic_xray.html#Heat">Heat</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/dynamical_magnetic_xray.html#Numerical-Phonons">Numerical Phonons</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/dynamical_magnetic_xray.html#Magnetization">Magnetization</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/dynamical_magnetic_xray.html#Initialize-dynamical-magnetic-X-ray-simulations">Initialize dynamical magnetic X-ray simulations</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/dynamical_magnetic_xray.html#Homogeneous-magnetic-X-ray-scattering">Homogeneous magnetic X-ray scattering</a><ul>
<li class="toctree-l4"><a class="reference internal" href="examples/dynamical_magnetic_xray.html#q_z-scan"><span class="math notranslate nohighlight">\(q_z\)</span>-scan</a></li>
<li class="toctree-l4"><a class="reference internal" href="examples/dynamical_magnetic_xray.html#Post-Processing">Post-Processing</a></li>
<li class="toctree-l4"><a class="reference internal" href="examples/dynamical_magnetic_xray.html#Energy--and-q_z-scan">Energy- and <span class="math notranslate nohighlight">\(q_z\)</span>-scan</a></li>
<li class="toctree-l4"><a class="reference internal" href="examples/dynamical_magnetic_xray.html#Polarization-dependence">Polarization dependence</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="examples/dynamical_magnetic_xray.html#Inhomogeneous-dynamical-magnetic-X-ray-scattering">Inhomogeneous dynamical magnetic X-ray scattering</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/dynamical_magnetic_xray.html#Parallel-dynamical-X-ray-scattering">Parallel dynamical X-ray scattering</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="api.html">API Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="atoms.html"><code class="docutils literal notranslate"><span class="pre">structures.atoms</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="layers.html"><code class="docutils literal notranslate"><span class="pre">structures.layers</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="structure.html"><code class="docutils literal notranslate"><span class="pre">structures.structure</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="simulation.html"><code class="docutils literal notranslate"><span class="pre">simulations.simulation</span></code></a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#"><code class="docutils literal notranslate"><span class="pre">simulations.heat</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="phonons.html"><code class="docutils literal notranslate"><span class="pre">simulations.phonons</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="magnetization.html"><code class="docutils literal notranslate"><span class="pre">simulations.magnetization</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="xrays.html"><code class="docutils literal notranslate"><span class="pre">simulations.xrays</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="helpers.html"><code class="docutils literal notranslate"><span class="pre">helpers</span></code></a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">udkm1Dsim</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="api.html">API Documentation</a> &raquo;</li>
        
      <li><code class="docutils literal notranslate"><span class="pre">simulations.heat</span></code></li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/heat.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="module-udkm1Dsim.simulations.heat">
<span id="simulations-heat"></span><h1><code class="docutils literal notranslate"><span class="pre">simulations.heat</span></code><a class="headerlink" href="#module-udkm1Dsim.simulations.heat" title="Permalink to this headline">¶</a></h1>
<p><strong>Classes:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#udkm1Dsim.simulations.heat.Heat" title="udkm1Dsim.simulations.heat.Heat"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Heat</span></code></a>(S, force_recalc, **kwargs)</p></td>
<td><p>Heat simulations including laser excitation and N-temperature model.</p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt id="udkm1Dsim.simulations.heat.Heat">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">udkm1Dsim.simulations.heat.</span></code><code class="sig-name descname"><span class="pre">Heat</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">S</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_recalc</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#udkm1Dsim.simulations.heat.Heat" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="simulation.html#udkm1Dsim.simulations.simulation.Simulation" title="udkm1Dsim.simulations.simulation.Simulation"><code class="xref py py-class docutils literal notranslate"><span class="pre">udkm1Dsim.simulations.simulation.Simulation</span></code></a></p>
<p>Heat simulations including laser excitation and N-temperature model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>S</strong> (<a class="reference internal" href="structure.html#udkm1Dsim.structures.structure.Structure" title="udkm1Dsim.structures.structure.Structure"><em>Structure</em></a>) – sample to do simulations with.</p></li>
<li><p><strong>force_recalc</strong> (<em>boolean</em>) – force recalculation of results.</p></li>
</ul>
</dd>
<dt class="field-even">Keyword Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>save_data</strong> (<em>boolean</em>) – true to save simulation results.</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – path to cached data.</p></li>
<li><p><strong>disp_messages</strong> (<em>boolean</em>) – true to display messages from within the
simulations.</p></li>
<li><p><strong>progress_bar</strong> (<em>boolean</em>) – enable tqdm progress bar.</p></li>
<li><p><strong>heat_diffusion</strong> (<em>boolean</em>) – true when including heat diffusion in the
calculations.</p></li>
<li><p><strong>intp_at_interface</strong> (<em>int</em>) – number of additional spacial points at the
interface of each layer.</p></li>
<li><p><strong>backend</strong> (<em>str</em>) – pde solver backend - either default scipy or matlab.</p></li>
</ul>
</dd>
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>S</strong> (<em>Structure</em>) – sample structure to calculate simulations on.</p></li>
<li><p><strong>force_recalc</strong> (<em>boolean</em>) – force recalculation of results.</p></li>
<li><p><strong>save_data</strong> (<em>boolean</em>) – true to save simulation results.</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – path to cached data.</p></li>
<li><p><strong>disp_messages</strong> (<em>boolean</em>) – true to display messages from within the
simulations.</p></li>
<li><p><strong>progress_bar</strong> (<em>boolean</em>) – enable tqdm progress bar.</p></li>
<li><p><strong>heat_diffusion</strong> (<em>boolean</em>) – true when including heat diffusion in the
calculations.</p></li>
<li><p><strong>intp_at_interface</strong> (<em>int</em>) – number of additional spacial points at the
interface of each layer.</p></li>
<li><p><strong>backend</strong> (<em>str</em>) – pde solver backend - either default scipy or matlab.</p></li>
<li><p><strong>excitation</strong> (<em>dict{ndarray[float, Quantity]}</em>) – excitation parameters
fluence, delay_pump, pulse_width, wavelength, theta, polarization,
multilayer_absorption</p></li>
<li><p><strong>boundary_conditions</strong> (<em>dict{str, float, Quantity}</em>) – boundary conditions of
the top and bottom boundary for the heat diffusion calculation.
<code class="docutils literal notranslate"><span class="pre">top_type</span></code> or <code class="docutils literal notranslate"><span class="pre">bottom_type</span></code> must be one of <code class="docutils literal notranslate"><span class="pre">boundary_types</span></code>.
For the last two types the corresponding value, <code class="docutils literal notranslate"><span class="pre">top_value</span></code> and
<code class="docutils literal notranslate"><span class="pre">bottom_value</span></code> have to be set as <span class="math notranslate nohighlight">\(K \times 1\)</span> array, where
<span class="math notranslate nohighlight">\(K\)</span> is the number of sub-systems.</p></li>
<li><p><strong>boundary_types</strong> (<em>list[str]</em>) – description of boundary types.</p>
<ul>
<li><p>isolator</p></li>
<li><p>temperature</p></li>
<li><p>flux</p></li>
</ul>
</li>
<li><p><strong>distances</strong> (<em>ndarray[float, Quantity]</em>) – spatial grid for heat diffusion [m]</p></li>
<li><p><strong>ode_options</strong> (<em>dict</em>) – options for scipy solve_ivp ode solver</p></li>
<li><p><strong>ode_options_matlab</strong> (<em>dict</em>) – dict with options for the MATLAB pdepe
solver.</p></li>
<li><p><strong>matlab_engine</strong> (<em>module</em>) – MATLAB to Python API engine required for
calculating heat diffusion.</p></li>
</ul>
</dd>
</dl>
<p><strong>Methods:</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#udkm1Dsim.simulations.heat.Heat.get_hash" title="udkm1Dsim.simulations.heat.Heat.get_hash"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_hash</span></code></a>(delays, init_temp, **kwargs)</p></td>
<td><p>Returns a unique hash given by the <code class="docutils literal notranslate"><span class="pre">delays</span></code> and <code class="docutils literal notranslate"><span class="pre">init_temp</span></code> as well as the sample structure hash for relevant thermal parameters.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#udkm1Dsim.simulations.heat.Heat.check_initial_temperature" title="udkm1Dsim.simulations.heat.Heat.check_initial_temperature"><code class="xref py py-obj docutils literal notranslate"><span class="pre">check_initial_temperature</span></code></a>(init_temp[, distances])</p></td>
<td><p>Initial temperature for heat simulations can be either a scalar temperature which is assumed to be valid for all layers in the structure or a temperature profile is given with one temperature for each layer in the structure and for each subsystem.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#udkm1Dsim.simulations.heat.Heat.check_excitation" title="udkm1Dsim.simulations.heat.Heat.check_excitation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">check_excitation</span></code></a>(delays)</p></td>
<td><p>The optical excitation is a dictionary with fluence <span class="math notranslate nohighlight">\(F\)</span> [J/m²], delays <span class="math notranslate nohighlight">\(t\)</span> [s] of the pump events, and pulse width <span class="math notranslate nohighlight">\(\tau\)</span> [s].</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#udkm1Dsim.simulations.heat.Heat.get_absorption_profile" title="udkm1Dsim.simulations.heat.Heat.get_absorption_profile"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_absorption_profile</span></code></a>([distances])</p></td>
<td><p>Returns the spatial absorption profile <span class="math notranslate nohighlight">\(\mbox{d}A/\mbox{d}z\)</span>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#udkm1Dsim.simulations.heat.Heat.get_Lambert_Beer_absorption_profile" title="udkm1Dsim.simulations.heat.Heat.get_Lambert_Beer_absorption_profile"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_Lambert_Beer_absorption_profile</span></code></a>([distances])</p></td>
<td><p>The transmission is given by:</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#udkm1Dsim.simulations.heat.Heat.get_multilayers_absorption_profile" title="udkm1Dsim.simulations.heat.Heat.get_multilayers_absorption_profile"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_multilayers_absorption_profile</span></code></a>([distances])</p></td>
<td><p>Calculates the intensity, absorption and temperature increase profiles in each layer of a multilayers structure for p-polarized light.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#udkm1Dsim.simulations.heat.Heat.get_temperature_after_delta_excitation" title="udkm1Dsim.simulations.heat.Heat.get_temperature_after_delta_excitation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_temperature_after_delta_excitation</span></code></a>(…)</p></td>
<td><p>Calculate the final temperature and temperature change for each layer of the sample structure after an optical excitation with a fluence <span class="math notranslate nohighlight">\(F\)</span> [J/m^2] and an initial temperature <span class="math notranslate nohighlight">\(T_1\)</span> [K]:</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#udkm1Dsim.simulations.heat.Heat.get_temp_map" title="udkm1Dsim.simulations.heat.Heat.get_temp_map"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_temp_map</span></code></a>(delays, init_temp)</p></td>
<td><p>Returns a temperature profile for the sample structure after optical excitation.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#udkm1Dsim.simulations.heat.Heat.calc_temp_map" title="udkm1Dsim.simulations.heat.Heat.calc_temp_map"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_temp_map</span></code></a>(delays, input_init_temp)</p></td>
<td><p>Calculates the temperature profile for the sample structure after optical excitation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#udkm1Dsim.simulations.heat.Heat.calc_heat_diffusion" title="udkm1Dsim.simulations.heat.Heat.calc_heat_diffusion"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_heat_diffusion</span></code></a>(init_temp, distances, …)</p></td>
<td><p>Calculates a temperature profile including heat diffusion for a given delay array and initial temperature profile.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#udkm1Dsim.simulations.heat.Heat.odefunc" title="udkm1Dsim.simulations.heat.Heat.odefunc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">odefunc</span></code></a>(t, u, N, K, d_x_grid, x, …)</p></td>
<td><p>Ordinary differential equation that is solved for 1D heat diffusion.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#udkm1Dsim.simulations.heat.Heat.conv_with_function" title="udkm1Dsim.simulations.heat.Heat.conv_with_function"><code class="xref py py-obj docutils literal notranslate"><span class="pre">conv_with_function</span></code></a>(y, x, handle)</p></td>
<td><p>Convolutes the array <span class="math notranslate nohighlight">\(y(x)\)</span> with a function given by the handle on the argument array <span class="math notranslate nohighlight">\(x\)</span>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#udkm1Dsim.simulations.heat.Heat.disp_message" title="udkm1Dsim.simulations.heat.Heat.disp_message"><code class="xref py py-obj docutils literal notranslate"><span class="pre">disp_message</span></code></a>(message)</p></td>
<td><p>Wrapper to display messages for that class.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#udkm1Dsim.simulations.heat.Heat.save" title="udkm1Dsim.simulations.heat.Heat.save"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code></a>(full_filename, data, *args)</p></td>
<td><p>Save data to file.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="udkm1Dsim.simulations.heat.Heat.get_hash">
<code class="sig-name descname"><span class="pre">get_hash</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delays</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_temp</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#udkm1Dsim.simulations.heat.Heat.get_hash" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a unique hash given by the <code class="docutils literal notranslate"><span class="pre">delays</span></code> and <code class="docutils literal notranslate"><span class="pre">init_temp</span></code> as
well as the sample structure hash for relevant thermal parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>delays</strong> (<em>ndarray</em><em>[</em><em>float</em><em>]</em>) – delay grid for the simulation.</p></li>
<li><p><strong>init_temp</strong> (<em>ndarray</em><em>[</em><em>float</em><em>]</em>) – initial spatial temperature profile.</p></li>
<li><p><strong>**kwargs</strong> (<em>float</em><em>, </em><em>optional</em>) – optional parameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>hash (str)</em> – unique hash.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="udkm1Dsim.simulations.heat.Heat.check_initial_temperature">
<code class="sig-name descname"><span class="pre">check_initial_temperature</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init_temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distances</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#udkm1Dsim.simulations.heat.Heat.check_initial_temperature" title="Permalink to this definition">¶</a></dt>
<dd><p>Initial temperature for heat simulations can be either a scalar
temperature which is assumed to be valid for all layers in the
structure or a temperature profile is given with one temperature for
each layer in the structure and for each subsystem.
Alternatively a spatial grid can be provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_temp</strong> (<em>float</em><em>, </em><em>Quantity</em><em>, </em><em>ndarray</em><em>[</em><em>float</em><em>, </em><em>Quantity</em><em>]</em>) – initial
temperature scalar or array [K].</p></li>
<li><p><strong>distances</strong> (<em>ndarray</em><em>[</em><em>float</em><em>, </em><em>Quantity</em><em>]</em><em>, </em><em>optional</em>) – spatial grid of the
initial temperatrue.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>init_temp (ndarray[float])</em> – checked initial temperature as array on
the according spatial grid.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="udkm1Dsim.simulations.heat.Heat.check_excitation">
<code class="sig-name descname"><span class="pre">check_excitation</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delays</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#udkm1Dsim.simulations.heat.Heat.check_excitation" title="Permalink to this definition">¶</a></dt>
<dd><p>The optical excitation is a dictionary with fluence
<span class="math notranslate nohighlight">\(F\)</span> [J/m²], delays <span class="math notranslate nohighlight">\(t\)</span> [s] of the pump events, and pulse
width <span class="math notranslate nohighlight">\(\tau\)</span> [s]. <span class="math notranslate nohighlight">\(N\)</span> is the number of pump events.</p>
<p>Traverse excitation vector to update the <code class="docutils literal notranslate"><span class="pre">delay_pump</span></code> <span class="math notranslate nohighlight">\(t_p\)</span>
vector for finite pulse durations <span class="math notranslate nohighlight">\(w(i)\)</span> as follows</p>
<div class="math notranslate nohighlight">
\[[t_p(i)-\mbox{window}\cdot w(i)]:[t_p(i)+\mbox{window}\cdot w(i)]:
[w(i)/\mbox{intp}]\]</div>
<p>and to combine excitations which have overlapping intervalls.</p>
<p>Moreover the incidence angle <span class="math notranslate nohighlight">\(\vartheta\)</span> is taken into account for
the user-defined incidence fluence in order to project the laser
footprint onto the sample surface.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>delays</strong> (<em>ndarray</em><em>[</em><em>Quantity</em><em>]</em>) – delays range of simulation [s].</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><em>(tuple)</em> –</p>
<ul class="simple">
<li><p><em>res (list[ndarray[float]])</em> - resulting list of excitations with
interpolated delay density around excitations.</p></li>
<li><p><em>fluence (ndarray[float])</em> - projected excitation fluences.</p></li>
<li><p><em>delay_pump (ndarray[float])</em> - delays of the excitations.</p></li>
<li><p><em>pulse_width (ndarray[float])</em> - pulse widths of the excitations.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="udkm1Dsim.simulations.heat.Heat.get_absorption_profile">
<code class="sig-name descname"><span class="pre">get_absorption_profile</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">distances</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#udkm1Dsim.simulations.heat.Heat.get_absorption_profile" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the spatial absorption profile <span class="math notranslate nohighlight">\(\mbox{d}A/\mbox{d}z\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>distances</strong> (<em>ndarray</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – spatial grid for calculation.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>absorption_profile (ndarray[float])</em> – absorption profile calculated
either by Lambert-Beers law or by a multilayer absorption formalism.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="udkm1Dsim.simulations.heat.Heat.get_Lambert_Beer_absorption_profile">
<code class="sig-name descname"><span class="pre">get_Lambert_Beer_absorption_profile</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">distances</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#udkm1Dsim.simulations.heat.Heat.get_Lambert_Beer_absorption_profile" title="Permalink to this definition">¶</a></dt>
<dd><p>The transmission is given by:</p>
<div class="math notranslate nohighlight">
\[\tau = \frac{I}{I_0} =  \exp(-z/ \zeta)\]</div>
<p>and the absorption by:</p>
<div class="math notranslate nohighlight">
\[\alpha = 1 - \tau =  1 - \exp(-z/\zeta)\]</div>
<p>The absorption profile can be derived from the spatial derivative:</p>
<div class="math notranslate nohighlight">
\[\frac{\mbox{d}\alpha(z)}{\mbox{d}z} = \frac{1}{\zeta}
\exp(-z/\zeta)\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>distances</strong> (<em>ndarray</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – spatial grid for calculation.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>absorption_profile (ndarray[float])</em> – absorption profile calculated
by Lambert-Beers law.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="udkm1Dsim.simulations.heat.Heat.get_multilayers_absorption_profile">
<code class="sig-name descname"><span class="pre">get_multilayers_absorption_profile</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">distances</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#udkm1Dsim.simulations.heat.Heat.get_multilayers_absorption_profile" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the intensity, absorption and temperature increase profiles
in each layer of a multilayers structure for p-polarized light.</p>
<p>Calculation of intensity, absorption and temperature increase profiles
in multilayers.</p>
<p>Calculation based on the method in Ref <a class="footnote-reference brackets" href="#id3" id="id1">5</a> and code developed Matlab
by L. Le Guyader, see Ref <a class="footnote-reference brackets" href="#id4" id="id2">6</a>.</p>
<p>Copyright (2012-2014) Loïc Le Guyader &lt;<a class="reference external" href="mailto:loic&#46;le_guyader&#37;&#52;&#48;helmholtz-berlin&#46;de">loic<span>&#46;</span>le_guyader<span>&#64;</span>helmholtz-berlin<span>&#46;</span>de</a>&gt;</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>distances</strong> (<em>ndarray</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – spatial grid for calculation.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><em>(tuple)</em> –</p>
<ul class="simple">
<li><p><em>dAdz (ndarray[float])</em> - differential absorption within each
layer.</p></li>
<li><p><em>Ints (ndarray[float])</em> - intensity profiles within each layer.</p></li>
<li><p><em>R_total (float)</em> - total amount of reflection from the
multilayer.</p></li>
<li><p><em>T_total (float)</em> - total transmission in the last layer of the
multilayer.</p></li>
</ul>
</p>
</dd>
</dl>
<p>References:</p>
<dl class="footnote brackets">
<dt class="label" id="id3"><span class="brackets"><a class="fn-backref" href="#id1">5</a></span></dt>
<dd><p>K. Ohta &amp; H. Ishida, <em>Matrix formalism for calculation of the
light beam intensity in stratified multilayered films, and its use
in the analysis of emission spectra</em>, <a class="reference external" href="https://doi.org/10.1364/AO.29.002466">Appl. Opt. 29, 2466 (1990).</a></p>
</dd>
<dt class="label" id="id4"><span class="brackets"><a class="fn-backref" href="#id2">6</a></span></dt>
<dd><p>L. Le Guyader, A. Kleibert, F. Nolting, L. Joly, P.M. Derlet,
R.V. Pisarev, A. Kirilyuk, Th. Rasing &amp; A.V. Kimel, <em>Dynamics of
laser-induced spin reorientation in Co/SmFeO_3 heterostructure</em>,
<a class="reference external" href="https://doi.org/10.1103/PhysRevB.87.054437">Phys. Rev. B 87, 054437 (2013).</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="udkm1Dsim.simulations.heat.Heat.get_temperature_after_delta_excitation">
<code class="sig-name descname"><span class="pre">get_temperature_after_delta_excitation</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fluence</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distances</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#udkm1Dsim.simulations.heat.Heat.get_temperature_after_delta_excitation" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the final temperature and temperature change for each layer
of the sample structure after an optical excitation with a fluence
<span class="math notranslate nohighlight">\(F\)</span> [J/m^2] and an initial temperature <span class="math notranslate nohighlight">\(T_1\)</span> [K]:</p>
<div class="math notranslate nohighlight">
\[\Delta E = \int_{T_1}^{T_2} m \, c(T)\, \mbox{d}T\]</div>
<p>where <span class="math notranslate nohighlight">\(\Delta E\)</span> is the absorbed energy in each layer and
<span class="math notranslate nohighlight">\(c(T)\)</span> is the temperature-dependent heat capacity [J/kg K] and
<span class="math notranslate nohighlight">\(m\)</span> is the mass [kg].</p>
<p>The absorbed energy per layer can be linearized from the absorption
profile <span class="math notranslate nohighlight">\(\mbox{d} \alpha / \mbox{d}z\)</span> as</p>
<div class="math notranslate nohighlight">
\[\Delta E = \frac{\mbox{d} \alpha}{\mbox{d}z} E_0 \Delta z\]</div>
<p>where <span class="math notranslate nohighlight">\(E_0\)</span> is the initial energy impinging on the first layer
given by the fluence <span class="math notranslate nohighlight">\(F = E / A\)</span>. <span class="math notranslate nohighlight">\(\Delta z\)</span> is equal to
the thickness of each layer.</p>
<p>Finally, one has to minimize the following modulus to obtain the
final temperature <span class="math notranslate nohighlight">\(T_2\)</span> of each layer:</p>
<div class="math notranslate nohighlight">
\[\left| \int_{T_1}^{T_2} m c(T)\, \mbox{d}T - \frac{\mbox{d}\alpha}
{\mbox{d}z} E_0 \Delta z \right| \stackrel{!}{=} 0\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fluence</strong> (<em>float</em><em>, </em><em>Quantity</em>) – incident fluence [J/m²].</p></li>
<li><p><strong>init_temp</strong> (<em>float</em><em>, </em><em>Quantity</em><em>, </em><em>ndarray</em><em>[</em><em>float</em><em>, </em><em>Quantity</em><em>]</em>) – initial
temperature scalar or array [K].</p></li>
<li><p><strong>distances</strong> (<em>ndarray</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – spatial grid for calculation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><em>(tuple)</em> –</p>
<ul class="simple">
<li><p><em>final_temp (ndarray[float])</em> - final temperature after delta
excitation.</p></li>
<li><p><em>delta_T (ndarray[float])</em> - temperature change.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="udkm1Dsim.simulations.heat.Heat.get_temp_map">
<code class="sig-name descname"><span class="pre">get_temp_map</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delays</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_temp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#udkm1Dsim.simulations.heat.Heat.get_temp_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a temperature profile for the sample structure after optical
excitation. The result can be saved using an unique hash of the sample
and the simulation parameters in order to reuse it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>delays</strong> (<em>ndarray</em><em>[</em><em>Quantity</em><em>]</em>) – delays range of simulation [s].</p></li>
<li><p><strong>init_temp</strong> (<em>float</em><em>, </em><em>Quantity</em><em>, </em><em>ndarray</em><em>[</em><em>float</em><em>, </em><em>Quantity</em><em>]</em>) – initial
temperature scalar or array [K].</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><em>(tuple)</em> –</p>
<ul class="simple">
<li><p><em>temp_map (ndarray[float])</em> - spatio-temporal temperature map.</p></li>
<li><p><em>delta_temp_map (ndarray[float])</em> - spatio-temporal temperature
change map.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="udkm1Dsim.simulations.heat.Heat.calc_temp_map">
<code class="sig-name descname"><span class="pre">calc_temp_map</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delays</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_init_temp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#udkm1Dsim.simulations.heat.Heat.calc_temp_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the temperature profile for the sample structure after optical
excitation. Heat diffusion can be included if <code class="docutils literal notranslate"><span class="pre">heat_diffusion</span> <span class="pre">=</span> <span class="pre">true</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>delays</strong> (<em>ndarray</em><em>[</em><em>Quantity</em><em>]</em>) – delays range of simulation [s].</p></li>
<li><p><strong>input_init_temp</strong> (<em>float</em><em>, </em><em>Quantity</em><em>, </em><em>ndarray</em><em>[</em><em>float</em><em>, </em><em>Quantity</em><em>]</em>) – initial
temperature scalar or array [K].</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><em>(tuple)</em> –</p>
<ul class="simple">
<li><p><em>temp_map (ndarray[float])</em> - spatio-temporal temperature map.</p></li>
<li><p><em>delta_temp_map (ndarray[float])</em> - spatio-temporal temperature
change map.</p></li>
<li><p><em>checked_excitations (list[ndarray[float]])</em> - resulting list of
checked excitations.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="udkm1Dsim.simulations.heat.Heat.calc_heat_diffusion">
<code class="sig-name descname"><span class="pre">calc_heat_diffusion</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init_temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distances</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delays</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delay_pump</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pulse_width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fluence</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#udkm1Dsim.simulations.heat.Heat.calc_heat_diffusion" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates a temperature profile including heat diffusion for a given
delay array and initial temperature profile. Here we have to solve the
1D heat diffusion equation for <span class="math notranslate nohighlight">\(N\)</span> subsystems:</p>
<div class="math notranslate nohighlight">
\[\begin{split}c_1(T_1) \rho \frac{\partial T_1}{\partial t} &amp; = &amp; \frac{\partial}{\partial z}
  \left( k_1(T_1) \frac{\partial T_1}{\partial z} \right)
  + G_1(T_1,...,T_N) + S(z,t) \\
&amp; \vdots &amp;  \\
c_N(T_N) \rho \frac{\partial T_N}{\partial t} &amp; = &amp; \frac{\partial}{\partial z}
  \left( k_N(T_N) \frac{\partial T_N}{\partial z} \right) + G_N(T_1,...,T_N)\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(T_i\)</span> is the temperature [K], <span class="math notranslate nohighlight">\(z\)</span> the distance [m],
<span class="math notranslate nohighlight">\(t\)</span> the delay [s], <span class="math notranslate nohighlight">\(c_i(T)\)</span> the temperature dependent heat
capacity [J/kg K], <span class="math notranslate nohighlight">\(\rho\)</span> the density [kg/m³] and <span class="math notranslate nohighlight">\(k_i(T)\)</span>
is the temperature-dependent thermal conductivity [W/m K] and
<span class="math notranslate nohighlight">\(S(z,t)\)</span> is a source term [W/m³].
The energy flow between the subsystems is given by the <code class="docutils literal notranslate"><span class="pre">sub_system_coupling</span></code>
parameter <span class="math notranslate nohighlight">\(G_i(T_1,...,T_N)\)</span> of the individual layers.
The index <span class="math notranslate nohighlight">\(i\)</span> referrs to the <span class="math notranslate nohighlight">\(i\)</span>-th subsystem.</p>
<p>The 1D heat diffusion equation can be either solved with SciPy or
Matlab as backend.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_temp</strong> (<em>float</em><em>, </em><em>Quantity</em><em>, </em><em>ndarray</em><em>[</em><em>float</em><em>, </em><em>Quantity</em><em>]</em>) – initial
temperature scalar or array [K].</p></li>
<li><p><strong>distances</strong> (<em>ndarray</em><em>[</em><em>float</em><em>]</em>) – spatial grid for calculation.</p></li>
<li><p><strong>delays</strong> (<em>ndarray</em><em>[</em><em>Quantity</em><em>]</em>) – delays range of simulation [s].</p></li>
<li><p><strong>delay_pump</strong> (<em>ndarray</em><em>[</em><em>float</em><em>]</em>) – delays of the excitations.</p></li>
<li><p><strong>pulse_width</strong> (<em>ndarray</em><em>[</em><em>float</em><em>]</em>) – pulse widths of the excitations.</p></li>
<li><p><strong>fluence</strong> (<em>ndarray</em><em>[</em><em>float</em><em>]</em>) – excitation fluences.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>temp_map (ndarray[float])</em> – spatio-temporal temperature map.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="udkm1Dsim.simulations.heat.Heat.odefunc">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">odefunc</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_x_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thermal_conds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">heat_capacities</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub_system_coupling</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">densities</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dalpha_dz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fluence</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delay_pump</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pulse_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bc_top_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bc_top_value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bc_bottom_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bc_bottom_value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pbar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#udkm1Dsim.simulations.heat.Heat.odefunc" title="Permalink to this definition">¶</a></dt>
<dd><p>Ordinary differential equation that is solved for 1D heat diffusion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>ndarray</em><em>[</em><em>float</em><em>]</em>) – internal time steps of the ode solver.</p></li>
<li><p><strong>u</strong> (<em>ndarray</em><em>[</em><em>float</em><em>]</em>) – internal variable of the ode solver.</p></li>
<li><p><strong>N</strong> (<em>int</em>) – number of spatial grid points.</p></li>
<li><p><strong>K</strong> (<em>int</em>) – number of sub-systems.</p></li>
<li><p><strong>d_x_grid</strong> (<em>ndarray</em><em>[</em><em>float</em><em>]</em>) – derivative of spatial grid.</p></li>
<li><p><strong>x</strong> (<em>ndarray</em><em>[</em><em>float</em><em>]</em>) – start point of actual layers.</p></li>
<li><p><strong>thermal_conds</strong> (<em>ndarray</em><em>[</em><em>&#64;lambda</em><em>]</em>) – T-dependent thermal conductivity
function handles.</p></li>
<li><p><strong>heat_capacities</strong> (<em>ndarray</em><em>[</em><em>&#64;lambda</em><em>]</em>) – T-dependent heat capacity
function handles.</p></li>
<li><p><strong>sub_system_coupling</strong> (<em>ndarray</em><em>[</em><em>&#64;lambda</em><em>]</em>) – T-dependent sub-system
coupling.</p></li>
<li><p><strong>densities</strong> (<em>ndarray</em><em>[</em><em>float</em><em>]</em>) – density of layers.</p></li>
<li><p><strong>indices</strong> (<em>ndarray</em><em>[</em><em>int</em><em>]</em>) – indices of actual layers in respect to
interpolated spatial grid.</p></li>
<li><p><strong>dalpha_dz</strong> (<em>ndarray</em><em>[</em><em>float</em><em>]</em>) – absorption profile.</p></li>
<li><p><strong>fluence</strong> (<em>ndarray</em><em>[</em><em>float</em><em>]</em>) – excitation fluences.</p></li>
<li><p><strong>delay_pump</strong> (<em>ndarray</em><em>[</em><em>float</em><em>]</em>) – delay of excitations.</p></li>
<li><p><strong>pulse_length</strong> (<em>ndarray</em><em>[</em><em>float</em><em>]</em>) – pulse widths of excitations.</p></li>
<li><p><strong>bc_top_type</strong> (<em>int</em>) – top boundary type.</p></li>
<li><p><strong>bc_top_value</strong> (<em>ndarray</em><em>[</em><em>float</em><em>]</em>) – top boundary value.</p></li>
<li><p><strong>bc_bottom_type</strong> (<em>int</em>) – bottom boundary type.</p></li>
<li><p><strong>bc_bottom_value</strong> (<em>ndarray</em><em>[</em><em>float</em><em>]</em>) – bottom boundary value.</p></li>
<li><p><strong>pbar</strong> (<em>tqdm</em>) – tqdm progressbar.</p></li>
<li><p><strong>state</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – state variables for progress bar.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>dudt (ndarray[float])</em> – temporal derivative of internal variable.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="udkm1Dsim.simulations.heat.Heat.conv_with_function">
<code class="sig-name descname"><span class="pre">conv_with_function</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">handle</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#udkm1Dsim.simulations.heat.Heat.conv_with_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Convolutes the array <span class="math notranslate nohighlight">\(y(x)\)</span> with a function given by the handle
on the argument array <span class="math notranslate nohighlight">\(x\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>ndarray</em><em>[</em><em>float</em><em>]</em>) – y data.</p></li>
<li><p><strong>x</strong> (<em>ndarray</em><em>[</em><em>float</em><em>]</em>) – x data.</p></li>
<li><p><strong>handle</strong> (<em>&#64;lamdba</em>) – convolution function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>y_conv (ndarray[float])</em> – convoluted data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="udkm1Dsim.simulations.heat.Heat.disp_message">
<code class="sig-name descname"><span class="pre">disp_message</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#udkm1Dsim.simulations.heat.Heat.disp_message" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper to display messages for that class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>message</strong> (<em>str</em>) – message to display.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="udkm1Dsim.simulations.heat.Heat.save">
<code class="sig-name descname"><span class="pre">save</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">full_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#udkm1Dsim.simulations.heat.Heat.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save data to file. The variable name can be handed as variable argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>full_filename</strong> (<em>str</em>) – full file name to data file.</p></li>
<li><p><strong>data</strong> (<em>ndarray</em>) – actual data to save.</p></li>
<li><p><strong>*args</strong> (<em>str</em><em>, </em><em>optional</em>) – variable name within the data file.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="phonons.html" class="btn btn-neutral float-right" title="simulations.phonons" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="simulation.html" class="btn btn-neutral float-left" title="simulations.simulation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, Daniel Schick.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>