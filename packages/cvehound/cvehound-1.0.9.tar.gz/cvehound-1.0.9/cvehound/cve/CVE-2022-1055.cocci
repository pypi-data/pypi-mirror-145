/// Files: net/sched/cls_api.c
/// Fix: 04c2a47ffb13c29778e2a14e414ad4cb5a5db4b5
/// Fixes: 470502de5bdb1ed0def643a4458593a40b8f6b66

virtual detect

@err_tc_new_tfilter@
identifier q, chain, replay;
position p;
@@

tc_new_tfilter(...)
{
	...
*	struct Qdisc *q;
	...
replay:
	... when != q = NULL;
*	\(__tcf_qdisc_find@p\|tcf_block_find@p\)(..., &q, ...)
	...
}


@script:python depends on detect@
p << err_tc_new_tfilter.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2022-1055')
