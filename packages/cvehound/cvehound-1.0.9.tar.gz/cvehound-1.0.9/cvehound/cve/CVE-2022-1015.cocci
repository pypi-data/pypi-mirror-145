/// Files: net/netfilter/nf_tables_api.c
/// Fix: 6e1acfa387b9ff82cfc7db8cc3b6959221a95851
/// Fixes: 49499c3e6e18b7677a63316f3ff54a16533dc28f

virtual detect

@fix exists@
identifier preg, attr;
@@

nft_parse_register(const struct nlattr *attr, u32 *preg)
{
	...
*	return -ERANGE;
	...
}

@err exists@
position p;
@@

* nft_parse_register@p(...)
{
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2022-1015')
