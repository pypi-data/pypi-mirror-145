"use strict";(self["webpackChunknonebot_plugin_gocqhttp_frontend"]=self["webpackChunknonebot_plugin_gocqhttp_frontend"]||[]).push([[288],{1803:(e,t,l)=>{l.d(t,{Z:()=>Q});var n=l(3673),o=l(2323),a=l(1959),u=l(7704),i=l(6643),r=l.n(i),c=l(2381),s=function(e,t,l,n){function o(e){return e instanceof l?e:new l((function(t){t(e)}))}return new(l||(l=Promise))((function(l,a){function u(e){try{r(n.next(e))}catch(t){a(t)}}function i(e){try{r(n["throw"](e))}catch(t){a(t)}}function r(e){e.done?l(e.value):o(e.value).then(u,i)}r((n=n.apply(e,t||[])).next())}))};const d=(0,n._)("div",{class:"text-h5 self-start"},"进程日志",-1),p={key:0},v=["innerHTML"],m={key:0,class:"timestamp"},f={key:1,class:"level"},w=["innerHTML"],_=(0,n.aZ)({props:{logs:null,connected:{type:Boolean},height:null},emits:["reconnect"],setup(e,{emit:t}){const l=e,i="当前版本:",_={[c.dJ.Debug]:"level-debug",[c.dJ.Info]:"level-info",[c.dJ.Warning]:"level-warn",[c.dJ.Error]:"level-error",[c.dJ.Fatal]:"level-fatal",[c.dJ.Stdout]:"stdout"},g=new(r());g.use_classes=!0;const h=(0,a.iH)(),y=(0,a.iH)();return(0,n.YP)((()=>l.logs.length),(()=>s(this,void 0,void 0,(function*(){if(!y.value)return;const e=y.value.getScrollTarget(),{scrollTop:t,clientHeight:l,scrollHeight:o}=e;Math.abs(t+l-o)<=1&&(yield(0,n.Y3)(),e.scrollTop=o)})))),(l,r)=>{const s=(0,n.up)("q-space"),W=(0,n.up)("q-chip"),q=(0,n.up)("q-btn"),k=(0,n.up)("q-card-section"),b=(0,n.up)("q-card");return(0,n.wg)(),(0,n.j4)(b,null,{default:(0,n.w5)((()=>{var l;return[(0,n.Wm)(k,{class:"row q-gutter-x-md items-center justify-start"},{default:(0,n.w5)((()=>[d,(0,n.Wm)(s),"boolean"===typeof e.connected?((0,n.wg)(),(0,n.j4)(W,{key:0,onClick:r[0]||(r[0]=e=>t("reconnect",e)),clickable:!e.connected,color:e.connected?"positive":"negative",icon:e.connected?"link":"link_off"},{default:(0,n.w5)((()=>[(0,n.Uk)(" 状态: "+(0,o.zw)(e.connected?"实时":"断开"),1)])),_:1},8,["clickable","color","icon"])):(0,n.kq)("",!0),(0,n.Wm)(q,{onClick:r[1]||(r[1]=e=>{var t;return null===(t=y.value)||void 0===t?void 0:t.setScrollPercentage("vertical",1,300)}),flat:"",rounded:"",icon:"move_down",label:"跳转底部"})])),_:1}),(0,n.Wm)((0,a.SU)(u.Z),{ref_key:"scroll",ref:y,class:"page-logs",style:(0,o.j5)({height:null!==(l=e.height)&&void 0!==l?l:"calc(100vh - 10rem)"})},{default:(0,n.w5)((()=>[(0,n._)("div",{ref_key:"root",ref:h,class:"logs ansi-up-theme"},[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.logs,((e,t)=>{var l;return(0,n.wg)(),(0,n.iD)("div",{class:"line",key:t},["string"===typeof e?((0,n.wg)(),(0,n.iD)("div",p,[(0,n._)("code",{innerHTML:(0,a.SU)(g).ansi_to_html(e)},null,8,v)])):((0,n.wg)(),(0,n.iD)("div",{key:1,class:(0,o.C_)({start:e.message.startsWith(i)})},[e.time?((0,n.wg)(),(0,n.iD)("code",m,(0,o.zw)(new Date(e.time).toLocaleString()),1)):(0,n.kq)("",!0),e.level?((0,n.wg)(),(0,n.iD)("code",f,(0,o.zw)(e.level),1)):(0,n.kq)("",!0),(0,n._)("code",{innerHTML:(0,a.SU)(g).ansi_to_html(e.message),class:(0,o.C_)(_[null!==(l=e.level)&&void 0!==l?l:(0,a.SU)(c.dJ).Stdout])},null,10,w)],2))])})),128))],512)])),_:1},8,["style"])]})),_:1})}}});var g=l(151),h=l(5589),y=l(2025),W=l(7030),q=l(8240),k=l(7518),b=l.n(k);const Z=_,Q=Z;b()(_,"components",{QCard:g.Z,QCardSection:h.Z,QSpace:y.Z,QChip:W.Z,QBtn:q.Z,QScrollArea:u.Z})},8288:(e,t,l)=>{l.r(t),l.d(t,{default:()=>re});var n=l(3673),o=l(2323),a=l(1959),u=l(8825),i=l(1768);const r={class:"text-center"},c=(0,n._)("div",{class:"text-body1"},"CPU",-1),s={class:"text-body2"},d=(0,n._)("strong",null,"PID:",-1),p=(0,n._)("strong",null,"内存:",-1),v=(0,n._)("strong",null,"启动时间:",-1),m=(0,n.aZ)({props:{status:{type:Object,required:!0}},setup(e){return(t,l)=>{var a,u;const i=(0,n.up)("q-icon"),m=(0,n.up)("q-circular-progress"),f=(0,n.up)("q-avatar"),w=(0,n.up)("q-chip");return(0,n.wg)(),(0,n.iD)("div",r,[(0,n._)("div",null,[(0,n.Wm)(m,{"show-value":"",value:null===(a=e.status)||void 0===a?void 0:a.cpu_percent,"track-color":t.$q.dark.isActive?"grey-8":"grey-3",thickness:.1,size:"90px",color:"blue",class:"q-ma-sm"},{default:(0,n.w5)((()=>[(0,n.Wm)(i,{name:"developer_board",color:"accent",size:"30px"})])),_:1},8,["value","track-color","thickness"]),c,(0,n._)("code",s,(0,o.zw)(null===(u=e.status)||void 0===u?void 0:u.cpu_percent)+"%",1)]),(0,n.Wm)(w,null,{default:(0,n.w5)((()=>{var t;return[(0,n.Wm)(f,{color:"blue",icon:"account_tree"}),d,(0,n._)("code",null,(0,o.zw)(null===(t=e.status)||void 0===t?void 0:t.pid),1)]})),_:1}),(0,n.Wm)(w,null,{default:(0,n.w5)((()=>{var t,l;return[(0,n.Wm)(f,{color:"yellow",icon:"memory"}),p,(0,n._)("code",null,(0,o.zw)(((null!==(l=null===(t=e.status)||void 0===t?void 0:t.memory_used)&&void 0!==l?l:0)/Math.pow(1024,2)).toFixed(2))+"MB",1)]})),_:1}),(0,n.Wm)(w,null,{default:(0,n.w5)((()=>{var t,l;return[(0,n.Wm)(f,{color:"green",icon:"timer"}),v,(0,n._)("code",null,(0,o.zw)(new Date(1e3*(null!==(l=null===(t=e.status)||void 0===t?void 0:t.start_time)&&void 0!==l?l:0)).toLocaleString()),1)]})),_:1})])}}});var f=l(6122),w=l(4554),_=l(7030),g=l(5096),h=l(7518),y=l.n(h);const W=m,q=W;y()(m,"components",{QCircularProgress:f.Z,QIcon:w.Z,QChip:_.Z,QAvatar:g.Z});var k=l(1803),b=function(e,t,l,n){function o(e){return e instanceof l?e:new l((function(t){t(e)}))}return new(l||(l=Promise))((function(l,a){function u(e){try{r(n.next(e))}catch(t){a(t)}}function i(e){try{r(n["throw"](e))}catch(t){a(t)}}function r(e){e.done?l(e.value):o(e.value).then(u,i)}r((n=n.apply(e,t||[])).next())}))};const Z=(0,n.Uk)("没有群"),Q=(0,n.Uk)("没有好友"),U=(0,n.aZ)({props:{uin:{type:Number,required:!0}},setup(e){const t=e,l=(0,a.iH)("group"),u=(0,a.iH)(),r=(0,a.iH)([]),c=(0,a.iH)(),s=(0,a.iH)([]),d=(0,a.iH)();function p(){return b(this,void 0,void 0,(function*(){const{data:e}=yield i.api.accountApiApiUinApiPost(t.uin,"get_group_list",{no_cache:!0});return e}))}function v(){return b(this,void 0,void 0,(function*(){const{data:e}=yield i.api.accountApiApiUinApiPost(t.uin,"get_friend_list",{no_cache:!0});return e}))}function m(e,l){return b(this,void 0,void 0,(function*(){const{data:n}=yield i.api.accountApiApiUinApiPost(t.uin,"send_msg",Object.assign({message:e},l));return n}))}return(e,t)=>{const a=(0,n.up)("q-tab"),i=(0,n.up)("q-tabs"),f=(0,n.up)("q-separator"),w=(0,n.up)("q-img"),_=(0,n.up)("q-avatar"),g=(0,n.up)("q-item-section"),h=(0,n.up)("q-item-label"),y=(0,n.up)("q-item"),W=(0,n.up)("q-select"),q=(0,n.up)("q-btn"),k=(0,n.up)("q-tab-panel"),b=(0,n.up)("q-tab-panels"),U=(0,n.up)("q-input"),S=(0,n.up)("q-card-section"),P=(0,n.up)("q-card");return(0,n.wg)(),(0,n.j4)(P,null,{default:(0,n.w5)((()=>[(0,n.Wm)(i,{modelValue:l.value,"onUpdate:modelValue":t[0]||(t[0]=e=>l.value=e),"active-color":"primary"},{default:(0,n.w5)((()=>[(0,n.Wm)(a,{name:"group",label:"群聊",icon:"groups"}),(0,n.Wm)(a,{name:"friend",label:"好友",icon:"chat"})])),_:1},8,["modelValue"]),(0,n.Wm)(f),(0,n.Wm)(b,{modelValue:l.value,"onUpdate:modelValue":t[7]||(t[7]=e=>l.value=e),animated:""},{default:(0,n.w5)((()=>[(0,n.Wm)(k,{name:"group",class:"row justify-evenly"},{default:(0,n.w5)((()=>[(0,n.Wm)(W,{class:"col-8",modelValue:c.value,"onUpdate:modelValue":t[1]||(t[1]=e=>c.value=e),filled:"",onFilter:t[2]||(t[2]=(e,t,l)=>p().then((e=>t((()=>r.value=e))))),options:r.value,"option-label":"group_name","option-value":"group_id",label:"选择群聊","map-options":"","emit-value":""},{option:(0,n.w5)((e=>[(0,n.Wm)(y,(0,o.vs)((0,n.F4)(e.itemProps)),{default:(0,n.w5)((()=>[(0,n.Wm)(g,{avatar:""},{default:(0,n.w5)((()=>[(0,n.Wm)(_,null,{default:(0,n.w5)((()=>[(0,n.Wm)(w,{src:`http://p.qlogo.cn/gh/${e.opt.group_id}/${e.opt.group_id}/100/`},null,8,["src"])])),_:2},1024)])),_:2},1024),(0,n.Wm)(g,null,{default:(0,n.w5)((()=>[(0,n.Wm)(h,null,{default:(0,n.w5)((()=>[(0,n.Uk)((0,o.zw)(e.opt.group_name),1)])),_:2},1024),(0,n.Wm)(h,{caption:""},{default:(0,n.w5)((()=>[(0,n.Uk)((0,o.zw)(e.opt.group_id),1)])),_:2},1024)])),_:2},1024)])),_:2},1040)])),"no-option":(0,n.w5)((()=>[(0,n.Wm)(y,null,{default:(0,n.w5)((()=>[(0,n.Wm)(g,{class:"text-grey"},{default:(0,n.w5)((()=>[Z])),_:1})])),_:1})])),_:1},8,["modelValue","options"]),(0,n.Wm)(q,{class:"col-2",flat:"",icon:"send",color:"indigo",disable:!(u.value&&c.value),onClick:t[3]||(t[3]=e=>m(u.value,{group_id:c.value}).then((()=>{u.value=void 0})))},null,8,["disable"])])),_:1}),(0,n.Wm)(k,{name:"friend",class:"row justify-evenly"},{default:(0,n.w5)((()=>[(0,n.Wm)(W,{class:"col-8",modelValue:d.value,"onUpdate:modelValue":t[4]||(t[4]=e=>d.value=e),filled:"",onFilter:t[5]||(t[5]=(e,t,l)=>v().then((e=>t((()=>s.value=e))))),options:s.value,"option-label":"nickname","option-value":"user_id",label:"选择好友","map-options":"","emit-value":""},{option:(0,n.w5)((e=>[(0,n.Wm)(y,(0,o.vs)((0,n.F4)(e.itemProps)),{default:(0,n.w5)((()=>[(0,n.Wm)(g,{avatar:""},{default:(0,n.w5)((()=>[(0,n.Wm)(_,null,{default:(0,n.w5)((()=>[(0,n.Wm)(w,{src:`https://q1.qlogo.cn/g?b=qq&nk=${e.opt.user_id}&s=640`},null,8,["src"])])),_:2},1024)])),_:2},1024),(0,n.Wm)(g,null,{default:(0,n.w5)((()=>[(0,n.Wm)(h,null,{default:(0,n.w5)((()=>[(0,n.Uk)((0,o.zw)(e.opt.nickname),1)])),_:2},1024),(0,n.Wm)(h,{caption:""},{default:(0,n.w5)((()=>[(0,n.Uk)((0,o.zw)(e.opt.user_id),1)])),_:2},1024)])),_:2},1024)])),_:2},1040)])),"no-option":(0,n.w5)((()=>[(0,n.Wm)(y,null,{default:(0,n.w5)((()=>[(0,n.Wm)(g,{class:"text-grey"},{default:(0,n.w5)((()=>[Q])),_:1})])),_:1})])),_:1},8,["modelValue","options"]),(0,n.Wm)(q,{class:"col-2",flat:"",icon:"send",color:"deep-orange",disable:!(u.value&&d.value),onClick:t[6]||(t[6]=e=>m(u.value,{user_id:d.value}).then((()=>{u.value=void 0})))},null,8,["disable"])])),_:1})])),_:1},8,["modelValue"]),(0,n.Wm)(S,null,{default:(0,n.w5)((()=>[(0,n.Wm)(U,{modelValue:u.value,"onUpdate:modelValue":t[8]||(t[8]=e=>u.value=e),style:{height:"15vh"},autogrow:"",outlined:"",label:"消息正文",rules:[e=>!!String(e).trim()||"请输入消息正文"]},null,8,["modelValue","rules"])])),_:1})])),_:1})}}});var S=l(151),P=l(7547),C=l(3269),x=l(5869),j=l(5906),A=l(6602),H=l(7757),z=l(3414),V=l(2035),D=l(4027),I=l(2350),T=l(8240),L=l(5589),J=l(4842);const B=U,M=B;y()(U,"components",{QCard:S.Z,QTabs:P.Z,QTab:C.Z,QSeparator:x.Z,QTabPanels:j.Z,QTabPanel:A.Z,QSelect:H.Z,QItem:z.Z,QItemSection:V.Z,QAvatar:g.Z,QImg:D.Z,QItemLabel:I.Z,QBtn:T.Z,QCardSection:L.Z,QInput:J.Z});var F=function(e,t,l,n){function o(e){return e instanceof l?e:new l((function(t){t(e)}))}return new(l||(l=Promise))((function(l,a){function u(e){try{r(n.next(e))}catch(t){a(t)}}function i(e){try{r(n["throw"](e))}catch(t){a(t)}}function r(e){e.done?l(e.value):o(e.value).then(u,i)}r((n=n.apply(e,t||[])).next())}))};const $={class:"row col-12 col-md-4"},Y=(0,n._)("div",{class:"text-h5 q-px-md"},"进程状态",-1),O={key:1},G=(0,n._)("strong",null,"退出代码:",-1),N={class:"row justify-center"},R=(0,n.Uk)(" 日志条数"),E=(0,n.Uk)(" 重启次数"),K=(0,n.Uk)(" 显示登录二维码 "),X=(0,n.Uk)("刷新"),ee=(0,n.Uk)("停止"),te=(0,n.Uk)("启动"),le=(0,n.aZ)({props:{uin:null},setup(e){const t=e,l=(0,u.Z)(),r=(0,a.iH)(),c=(0,a.iH)([]),s=(0,a.iH)();function d(){var e;return F(this,void 0,void 0,(function*(){null===(e=s.value)||void 0===e||e.send("heartbeat");try{l.loadingBar.start();const{data:e}=yield i.api.processStatusApiUinProcessStatusGet(t.uin);r.value=e}catch(n){console.error(n)}finally{l.loadingBar.stop()}}))}function p(){return F(this,void 0,void 0,(function*(){try{l.loading.show(),yield i.api.processStopApiUinProcessDelete(t.uin),yield d()}catch(e){console.error(e)}finally{l.loading.hide()}}))}function v(){return F(this,void 0,void 0,(function*(){try{l.loading.show(),yield i.api.processStartApiUinProcessPut(t.uin),yield d()}catch(e){console.error(e)}finally{l.loading.hide()}}))}function m(){var e;return F(this,void 0,void 0,(function*(){const{data:l}=yield i.api.processLogsHistoryApiUinProcessLogsGet(t.uin);c.value=l,null===(e=s.value)||void 0===e||e.close();const n=new URL(`api/${t.uin}/process/logs`,location.href);n.protocol="https:"===n.protocol?"wss:":"ws:",s.value=new WebSocket(n.href),s.value.onmessage=({data:e})=>c.value.push(JSON.parse(e)),s.value.onclose=()=>s.value=void 0}))}const f=window.setInterval((()=>{d()}),3e3);return(0,n.YP)((()=>t.uin),(()=>F(this,void 0,void 0,(function*(){r.value=void 0,c.value=[];try{l.loading.show(),yield d(),yield m()}finally{l.loading.hide()}}))),{immediate:!0}),(0,n.Jd)((()=>{var e;window.clearInterval(f),null===(e=s.value)||void 0===e||e.close()})),d(),(t,l)=>{const a=(0,n.up)("q-img"),u=(0,n.up)("q-avatar"),i=(0,n.up)("q-icon"),f=(0,n.up)("q-chip"),w=(0,n.up)("q-card-section"),_=(0,n.up)("q-separator"),g=(0,n.up)("q-popup-proxy"),h=(0,n.up)("q-btn"),y=(0,n.up)("q-slide-transition"),W=(0,n.up)("q-card-actions"),b=(0,n.up)("q-card"),Z=(0,n.up)("q-page");return(0,n.wg)(),(0,n.j4)(Z,{class:"row q-pa-md justify-center"},{default:(0,n.w5)((()=>[(0,n._)("div",$,[(0,n.Wm)(b,{class:"col-12 shadow"},{default:(0,n.w5)((()=>[(0,n.Wm)(w,{class:"q-pa-md row items-center justify-start"},{default:(0,n.w5)((()=>[(0,n.Wm)(u,null,{default:(0,n.w5)((()=>[(0,n.Wm)(a,{src:`https://q1.qlogo.cn/g?b=qq&nk=${e.uin}&s=640`},null,8,["src"])])),_:1}),Y,(0,n.Wm)(f,{color:"green"},{default:(0,n.w5)((()=>[(0,n.Wm)(i,{name:"person"}),(0,n.Uk)("帐号: "+(0,o.zw)(e.uin),1)])),_:1})])),_:1}),(0,n.Wm)(_),(0,n.Wm)(y,null,{default:(0,n.w5)((()=>[r.value?((0,n.wg)(),(0,n.j4)(w,{key:0,class:"row justify-center items-center"},{default:(0,n.w5)((()=>["pid"in r.value.details?((0,n.wg)(),(0,n.j4)(q,{key:0,status:r.value.details},null,8,["status"])):((0,n.wg)(),(0,n.iD)("div",O,[(0,n.Wm)(f,null,{default:(0,n.w5)((()=>[(0,n.Wm)(u,{icon:"error",color:"red","text-color":"white"}),G,(0,n._)("code",null,(0,o.zw)(r.value.details.code),1)])),_:1})])),(0,n._)("div",N,[(0,n.Wm)(f,{outline:"",color:"green"},{default:(0,n.w5)((()=>[(0,n.Wm)(i,{name:"description",color:"accent"}),R,(0,n._)("code",null,(0,o.zw)(r.value.total_logs)+"条",1)])),_:1}),(0,n.Wm)(f,{outline:"",color:"red"},{default:(0,n.w5)((()=>[(0,n.Wm)(i,{name:"restart_alt",color:"accent"}),E,(0,n._)("code",null,(0,o.zw)(r.value.restarts)+"次",1)])),_:1})]),r.value.qr_uri?((0,n.wg)(),(0,n.j4)(y,{key:2,class:"q-ma-md"},{default:(0,n.w5)((()=>[(0,n.Wm)(h,{push:"",icon:"qr_code",color:"accent"},{default:(0,n.w5)((()=>[K,(0,n.Wm)(g,null,{default:(0,n.w5)((()=>[(0,n.Wm)(a,{width:"40vh",src:r.value.qr_uri},null,8,["src"])])),_:1})])),_:1})])),_:1})):(0,n.kq)("",!0)])),_:1})):(0,n.kq)("",!0)])),_:1}),(0,n.Wm)(_),(0,n.Wm)(W,{class:"justify-center"},{default:(0,n.w5)((()=>{var e;return[(0,n.Wm)(h,{flat:"",color:"primary",icon:"refresh",onClick:d},{default:(0,n.w5)((()=>[X])),_:1}),"running"==(null===(e=r.value)||void 0===e?void 0:e.status)?((0,n.wg)(),(0,n.j4)(h,{key:0,flat:"",color:"red",icon:"stop",onClick:p},{default:(0,n.w5)((()=>[ee])),_:1})):((0,n.wg)(),(0,n.j4)(h,{key:1,flat:"",color:"green",icon:"play_arrow",onClick:v},{default:(0,n.w5)((()=>[te])),_:1}))]})),_:1})])),_:1}),(0,n.Wm)(M,{class:"col-12 shadow",uin:e.uin},null,8,["uin"])]),(0,n.Wm)(k.Z,{class:"col-12 col-md-8",onReconnect:m,logs:c.value,connected:!!s.value},null,8,["logs","connected"])])),_:1})}}});var ne=l(4379),oe=l(2471),ae=l(3944),ue=l(9367);const ie=le,re=ie;y()(le,"components",{QPage:ne.Z,QCard:S.Z,QCardSection:L.Z,QAvatar:g.Z,QImg:D.Z,QChip:_.Z,QIcon:w.Z,QSeparator:x.Z,QSlideTransition:oe.Z,QBtn:T.Z,QPopupProxy:ae.Z,QCardActions:ue.Z})}}]);
//# sourceMappingURL=288.7085bc5f.js.map