import pandas as pd
import os
from string import Template
from typing import Dict

from metricflow.dataflow.sql_table import SqlTable
from metricflow.protocols.sql_client import SqlClient
from metricflow.sql_clients.sql_utils import make_df


COUNTRIES = [("US", "NA"), ("MX", "NA"), ("CA", "NA"), ("BR", "SA"), ("GR", "EU"), ("FR", "EU")]
TRANSACTION_TYPE = ["cancellation", "alteration", "quick-buy", "buy"]

CUSTOMERS_TABLE = "customers"
TRANSACTIONS_TABLE = "transactions"
COUNTRIES_TABLE = "countries"

TRANSACTIONS_YAML_FILE = os.path.join(os.path.dirname(__file__), "sample_models/transactions_test.yaml")
CUSTOMERS_YAML_FILE = os.path.join(os.path.dirname(__file__), "sample_models/customers_test.yaml")
COUNTRIES_YAML_FILE = os.path.join(os.path.dirname(__file__), "sample_models/countries_test.yaml")


def build_dataframe(sql_client: SqlClient, rows: int = 100) -> Dict[str, pd.DataFrame]:
    """Builds random data with some logic.

    Args:
        sql_client: SqlClient used to format the dataframe

    Returns:
        A dict containing {table_name: dataframe of data}
    """
    transaction_data = [
        ("s59936437", "o2116", "c500009", 236.6, "cancellation", "2022-04-13"),
        ("s59936438", "o1481", "c500013", 11.48, "buy", "2022-04-29"),
        ("s59936439", "o1547", "c500043", 177.19, "cancellation", "2022-04-25"),
        ("s59936440", "o1374", "c500350", 400.65, "cancellation", "2022-05-31"),
        ("s59936441", "o2070", "c500374", 238.49, "cancellation", "2022-05-29"),
        ("s59936442", "o1683", "c500313", 219.7, "buy", "2022-05-13"),
        ("s59936443", "o2163", "c500392", 418.12, "alteration", "2022-05-19"),
        ("s59936444", "o1958", "c500384", 37.5, "quick-buy", "2022-04-25"),
        ("s59936445", "o1100", "c500001", 306.44, "buy", "2022-04-05"),
        ("s59936446", "o2161", "c500132", 361.68, "buy", "2022-04-22"),
        ("s59936447", "o1432", "c500366", 226.9, "cancellation", "2022-05-01"),
        ("s59936448", "o2127", "c500233", 221.73, "alteration", "2022-05-26"),
        ("s59936449", "o1537", "c500027", 9.87, "alteration", "2022-04-12"),
        ("s59936450", "o1477", "c500055", 107.52, "quick-buy", "2022-04-17"),
        ("s59936451", "o1386", "c500150", 112.35, "buy", "2022-06-01"),
        ("s59936452", "o1176", "c500103", 332.73, "quick-buy", "2022-04-12"),
        ("s59936453", "o1408", "c500283", 411.36, "quick-buy", "2022-05-24"),
        ("s59936454", "o1562", "c500376", 251.75, "quick-buy", "2022-04-17"),
        ("s59936455", "o1453", "c500038", 217.18, "alteration", "2022-05-02"),
        ("s59936456", "o1818", "c500381", 433.1, "buy", "2022-05-01"),
        ("s59936457", "o1271", "c500392", 491.91, "alteration", "2022-05-01"),
        ("s59936458", "o1008", "c500354", 226.4, "buy", "2022-04-29"),
        ("s59936459", "o2188", "c500141", 367.18, "alteration", "2022-05-09"),
        ("s59936460", "o1863", "c500236", 9.08, "quick-buy", "2022-05-12"),
        ("s59936461", "o2055", "c500016", 260.34, "alteration", "2022-04-19"),
        ("s59936462", "o1392", "c500215", 409, "alteration", "2022-04-21"),
        ("s59936463", "o1687", "c500343", 124.46, "buy", "2022-06-01"),
        ("s59936464", "o1090", "c500151", 375.07, "cancellation", "2022-05-08"),
        ("s59936465", "o2119", "c500137", 495.53, "cancellation", "2022-05-10"),
        ("s59936466", "o1896", "c500391", 48.99, "cancellation", "2022-05-29"),
        ("s59936467", "o1851", "c500372", 185.53, "buy", "2022-05-15"),
        ("s59936468", "o2137", "c500126", 445.91, "quick-buy", "2022-04-21"),
        ("s59936469", "o1765", "c500180", 272.25, "buy", "2022-04-07"),
        ("s59936470", "o1372", "c500127", 267.71, "cancellation", "2022-05-31"),
        ("s59936471", "o1929", "c500127", 256.82, "alteration", "2022-04-13"),
        ("s59936472", "o1646", "c500295", 128.31, "quick-buy", "2022-05-25"),
        ("s59936473", "o1853", "c500278", 121.76, "alteration", "2022-04-13"),
        ("s59936474", "o1472", "c500094", 199.08, "cancellation", "2022-04-19"),
        ("s59936475", "o1543", "c500038", 353.24, "quick-buy", "2022-05-05"),
        ("s59936476", "o1715", "c500389", 459.61, "cancellation", "2022-05-12"),
        ("s59936477", "o2199", "c500082", 86.99, "alteration", "2022-04-22"),
        ("s59936478", "o1951", "c500203", 54.41, "alteration", "2022-05-28"),
        ("s59936479", "o1436", "c500232", 223.84, "buy", "2022-04-05"),
        ("s59936480", "o1931", "c500044", 464.5, "buy", "2022-05-20"),
        ("s59936481", "o1576", "c500291", 420.15, "cancellation", "2022-04-14"),
        ("s59936482", "o2065", "c500063", 196.62, "quick-buy", "2022-04-24"),
        ("s59936483", "o1140", "c500029", 359.14, "cancellation", "2022-04-08"),
        ("s59936484", "o1260", "c500140", 382.51, "alteration", "2022-05-16"),
        ("s59936485", "o2001", "c500316", 421.41, "quick-buy", "2022-05-19"),
        ("s59936486", "o1877", "c500200", 289.82, "quick-buy", "2022-04-13"),
        ("s59936487", "o1753", "c500210", 155.38, "buy", "2022-04-21"),
        ("s59936488", "o2030", "c500236", 235.31, "alteration", "2022-05-24"),
        ("s59936489", "o1462", "c500220", 402.4, "cancellation", "2022-04-21"),
        ("s59936490", "o1253", "c500121", 322.21, "quick-buy", "2022-05-25"),
        ("s59936491", "o1564", "c500010", 438.35, "buy", "2022-04-25"),
        ("s59936492", "o2042", "c500329", 460.23, "quick-buy", "2022-04-16"),
        ("s59936493", "o1891", "c500180", 406.08, "quick-buy", "2022-04-12"),
        ("s59936494", "o1005", "c500129", 140.16, "quick-buy", "2022-04-25"),
        ("s59936495", "o1441", "c500396", 172.59, "alteration", "2022-04-11"),
        ("s59936496", "o2173", "c500114", 212.36, "quick-buy", "2022-05-06"),
        ("s59936497", "o2042", "c500228", 192.25, "alteration", "2022-04-25"),
        ("s59936498", "o1791", "c500249", 433.24, "cancellation", "2022-04-08"),
        ("s59936499", "o1778", "c500218", 101.38, "buy", "2022-04-13"),
        ("s59936500", "o1824", "c500241", 414.38, "quick-buy", "2022-06-01"),
        ("s59936501", "o1752", "c500037", 482.79, "buy", "2022-05-24"),
        ("s59936502", "o1002", "c500204", 134.54, "cancellation", "2022-05-19"),
        ("s59936503", "o1808", "c500202", 177.99, "quick-buy", "2022-05-02"),
        ("s59936504", "o1049", "c500334", 239.15, "alteration", "2022-05-03"),
        ("s59936505", "o1097", "c500326", 405.26, "cancellation", "2022-05-10"),
        ("s59936506", "o1040", "c500164", 72.42, "cancellation", "2022-04-24"),
        ("s59936507", "o1902", "c500261", 475.57, "buy", "2022-04-27"),
        ("s59936508", "o1164", "c500368", 211.32, "cancellation", "2022-05-24"),
        ("s59936509", "o2136", "c500033", 276.22, "buy", "2022-05-20"),
        ("s59936510", "o1734", "c500244", 38.46, "buy", "2022-04-23"),
        ("s59936511", "o1059", "c500320", 175.64, "buy", "2022-04-18"),
        ("s59936512", "o1720", "c500017", 440.16, "buy", "2022-04-09"),
        ("s59936513", "o1763", "c500332", 351.69, "cancellation", "2022-04-06"),
        ("s59936514", "o1632", "c500304", 373.66, "alteration", "2022-04-20"),
        ("s59936515", "o1422", "c500089", 88.73, "buy", "2022-04-17"),
        ("s59936516", "o1036", "c500120", 221.22, "buy", "2022-04-29"),
        ("s59936517", "o1333", "c500236", 282.32, "cancellation", "2022-05-15"),
        ("s59936518", "o1006", "c500345", 122.72, "alteration", "2022-04-20"),
        ("s59936519", "o1368", "c500267", 465.72, "alteration", "2022-05-07"),
        ("s59936520", "o1952", "c500167", 30.65, "quick-buy", "2022-05-11"),
        ("s59936521", "o2125", "c500211", 254.31, "buy", "2022-05-17"),
        ("s59936522", "o1375", "c500271", 473.39, "quick-buy", "2022-04-23"),
        ("s59936523", "o2142", "c500399", 84.24, "buy", "2022-05-13"),
        ("s59936524", "o1765", "c500163", 65.57, "quick-buy", "2022-05-29"),
        ("s59936525", "o1039", "c500225", 499.2, "quick-buy", "2022-04-16"),
        ("s59936526", "o2023", "c500331", 330.34, "cancellation", "2022-05-15"),
        ("s59936527", "o2104", "c500002", 191.81, "quick-buy", "2022-04-09"),
        ("s59936528", "o1327", "c500301", 264.92, "alteration", "2022-04-24"),
        ("s59936529", "o1686", "c500228", 421.25, "cancellation", "2022-05-29"),
        ("s59936530", "o1139", "c500079", 69.76, "cancellation", "2022-05-06"),
        ("s59936531", "o1843", "c500253", 329.87, "quick-buy", "2022-04-21"),
        ("s59936532", "o1579", "c500069", 30.01, "cancellation", "2022-05-17"),
        ("s59936533", "o1545", "c500206", 140.61, "cancellation", "2022-04-10"),
        ("s59936534", "o2052", "c500385", 383.23, "alteration", "2022-04-04"),
        ("s59936535", "o1890", "c500010", 267.97, "alteration", "2022-04-05"),
        ("s59936536", "o1384", "c500011", 363.82, "alteration", "2022-04-18"),
        ("s59936537", "o1597", "c500068", 338.34, "alteration", "2022-04-28"),
        ("s59936538", "o1339", "c500100", 95.52, "alteration", "2022-04-26"),
        ("s59936539", "o2111", "c500175", 181.9, "cancellation", "2022-04-25"),
        ("s59936540", "o1774", "c500057", 133.09, "alteration", "2022-04-25"),
        ("s59936541", "o1312", "c500246", 220.44, "cancellation", "2022-04-06"),
        ("s59936542", "o2052", "c500172", 33.63, "cancellation", "2022-05-18"),
        ("s59936543", "o1336", "c500001", 6.28, "quick-buy", "2022-04-17"),
        ("s59936544", "o1728", "c500105", 136.99, "alteration", "2022-05-07"),
        ("s59936545", "o1042", "c500171", 273.9, "buy", "2022-04-25"),
        ("s59936546", "o1132", "c500019", 29.2, "alteration", "2022-05-24"),
        ("s59936547", "o1291", "c500298", 464.81, "buy", "2022-04-23"),
        ("s59936548", "o1783", "c500108", 480.23, "quick-buy", "2022-04-17"),
        ("s59936549", "o1631", "c500336", 30.54, "buy", "2022-04-20"),
        ("s59936550", "o1756", "c500261", 274.72, "quick-buy", "2022-05-12"),
        ("s59936551", "o2138", "c500025", 154.43, "buy", "2022-05-09"),
        ("s59936552", "o1371", "c500045", 368.26, "buy", "2022-06-02"),
        ("s59936553", "o2053", "c500217", 192.47, "quick-buy", "2022-05-06"),
        ("s59936554", "o1567", "c500094", 393.08, "buy", "2022-05-19"),
        ("s59936555", "o1441", "c500029", 380.06, "alteration", "2022-05-02"),
        ("s59936556", "o1365", "c500239", 221.12, "alteration", "2022-04-09"),
        ("s59936557", "o1834", "c500067", 438.16, "cancellation", "2022-04-27"),
        ("s59936558", "o1362", "c500155", 12.75, "cancellation", "2022-06-02"),
        ("s59936559", "o2165", "c500335", 426.53, "alteration", "2022-05-20"),
        ("s59936560", "o1632", "c500128", 76.62, "cancellation", "2022-05-01"),
        ("s59936561", "o1740", "c500216", 303.19, "quick-buy", "2022-06-01"),
        ("s59936562", "o1002", "c500064", 300.15, "cancellation", "2022-05-05"),
        ("s59936563", "o2023", "c500212", 11.94, "quick-buy", "2022-05-10"),
        ("s59936564", "o2193", "c500223", 472.31, "alteration", "2022-04-21"),
        ("s59936565", "o1979", "c500020", 322.4, "alteration", "2022-04-09"),
        ("s59936566", "o1326", "c500134", 152.75, "buy", "2022-05-31"),
        ("s59936567", "o2032", "c500005", 29.23, "quick-buy", "2022-05-11"),
        ("s59936568", "o1269", "c500135", 284.39, "quick-buy", "2022-05-10"),
        ("s59936569", "o1639", "c500143", 266.75, "cancellation", "2022-04-07"),
        ("s59936570", "o1402", "c500353", 330.9, "buy", "2022-05-15"),
        ("s59936571", "o1421", "c500042", 411.73, "alteration", "2022-05-05"),
        ("s59936572", "o1458", "c500323", 355.64, "cancellation", "2022-04-08"),
        ("s59936573", "o1444", "c500258", 313.81, "cancellation", "2022-04-23"),
        ("s59936574", "o1613", "c500223", 442.59, "buy", "2022-04-17"),
        ("s59936575", "o1788", "c500045", 404.01, "buy", "2022-04-12"),
        ("s59936576", "o1172", "c500277", 287.02, "quick-buy", "2022-05-06"),
        ("s59936577", "o1742", "c500166", 149.18, "buy", "2022-05-19"),
        ("s59936578", "o1265", "c500351", 354.63, "buy", "2022-05-02"),
        ("s59936579", "o1217", "c500319", 295.25, "cancellation", "2022-05-19"),
        ("s59936580", "o1564", "c500341", 176.86, "quick-buy", "2022-05-06"),
        ("s59936581", "o1374", "c500222", 403.93, "alteration", "2022-05-06"),
        ("s59936582", "o2088", "c500091", 284.86, "alteration", "2022-05-30"),
        ("s59936583", "o1413", "c500006", 124.76, "alteration", "2022-05-21"),
        ("s59936584", "o1471", "c500387", 263.74, "quick-buy", "2022-05-09"),
        ("s59936585", "o1111", "c500010", 393.87, "alteration", "2022-05-13"),
        ("s59936586", "o1580", "c500204", 348.7, "quick-buy", "2022-05-20"),
        ("s59936587", "o1314", "c500298", 392.85, "alteration", "2022-04-22"),
        ("s59936588", "o1542", "c500351", 152.58, "alteration", "2022-04-17"),
        ("s59936589", "o1204", "c500028", 391.22, "alteration", "2022-05-16"),
        ("s59936590", "o1225", "c500181", 494.14, "quick-buy", "2022-04-24"),
        ("s59936591", "o1144", "c500018", 229.5, "buy", "2022-04-21"),
        ("s59936592", "o1819", "c500172", 431.25, "quick-buy", "2022-05-22"),
        ("s59936593", "o2051", "c500107", 187.49, "quick-buy", "2022-05-21"),
        ("s59936594", "o1142", "c500299", 17.93, "quick-buy", "2022-05-01"),
        ("s59936595", "o1847", "c500314", 379.35, "cancellation", "2022-05-18"),
        ("s59936596", "o2051", "c500209", 47.23, "quick-buy", "2022-04-11"),
        ("s59936597", "o1404", "c500052", 372.98, "cancellation", "2022-05-04"),
        ("s59936598", "o1392", "c500096", 131.13, "cancellation", "2022-05-29"),
        ("s59936599", "o1539", "c500269", 272.67, "buy", "2022-05-04"),
        ("s59936600", "o1474", "c500268", 431.79, "buy", "2022-05-16"),
        ("s59936601", "o1942", "c500066", 153.89, "alteration", "2022-04-28"),
        ("s59936602", "o1061", "c500266", 70.02, "cancellation", "2022-05-31"),
        ("s59936603", "o1750", "c500051", 165.31, "quick-buy", "2022-04-11"),
        ("s59936604", "o2195", "c500213", 256, "quick-buy", "2022-05-17"),
        ("s59936605", "o2089", "c500205", 101.96, "quick-buy", "2022-05-13"),
        ("s59936606", "o1705", "c500332", 489.32, "buy", "2022-04-30"),
        ("s59936607", "o1092", "c500054", 159.17, "alteration", "2022-05-28"),
        ("s59936608", "o2158", "c500332", 295.53, "buy", "2022-05-06"),
        ("s59936609", "o1492", "c500127", 88.98, "cancellation", "2022-04-28"),
        ("s59936610", "o1374", "c500298", 206.62, "cancellation", "2022-04-26"),
        ("s59936611", "o2141", "c500015", 129.88, "buy", "2022-05-21"),
        ("s59936612", "o1422", "c500204", 42.66, "alteration", "2022-05-11"),
        ("s59936613", "o1802", "c500392", 109.97, "cancellation", "2022-05-02"),
        ("s59936614", "o1708", "c500375", 217.64, "quick-buy", "2022-04-12"),
        ("s59936615", "o1501", "c500202", 174.49, "alteration", "2022-05-12"),
        ("s59936616", "o1313", "c500098", 481.09, "buy", "2022-05-19"),
        ("s59936617", "o2129", "c500123", 393.28, "buy", "2022-05-31"),
        ("s59936618", "o1787", "c500006", 398.6, "alteration", "2022-05-17"),
        ("s59936619", "o1388", "c500303", 444.02, "alteration", "2022-05-17"),
        ("s59936620", "o2133", "c500087", 150.77, "cancellation", "2022-04-19"),
        ("s59936621", "o1143", "c500146", 199.46, "buy", "2022-04-10"),
        ("s59936622", "o1062", "c500269", 337.52, "alteration", "2022-05-08"),
        ("s59936623", "o1016", "c500013", 164.15, "alteration", "2022-04-22"),
        ("s59936624", "o2124", "c500230", 106.45, "cancellation", "2022-05-20"),
        ("s59936625", "o1488", "c500213", 142.55, "cancellation", "2022-04-19"),
        ("s59936626", "o2080", "c500192", 257.54, "cancellation", "2022-05-28"),
        ("s59936627", "o1406", "c500013", 251.66, "quick-buy", "2022-04-17"),
        ("s59936628", "o1676", "c500057", 299.86, "buy", "2022-04-22"),
        ("s59936629", "o1748", "c500343", 433.03, "alteration", "2022-05-21"),
        ("s59936630", "o1112", "c500058", 415.41, "alteration", "2022-04-29"),
        ("s59936631", "o2161", "c500320", 424.55, "cancellation", "2022-06-02"),
        ("s59936632", "o2147", "c500315", 31.91, "buy", "2022-04-13"),
        ("s59936633", "o1096", "c500124", 205.8, "alteration", "2022-06-02"),
        ("s59936634", "o1579", "c500196", 349.49, "quick-buy", "2022-05-19"),
        ("s59936635", "o1862", "c500388", 75.48, "buy", "2022-05-24"),
        ("s59936636", "o1148", "c500106", 22.3, "buy", "2022-05-16"),
        ("s59936637", "o1074", "c500379", 469.36, "cancellation", "2022-04-25"),
        ("s59936638", "o1308", "c500014", 441.31, "alteration", "2022-05-24"),
        ("s59936639", "o1651", "c500398", 60.98, "cancellation", "2022-04-10"),
        ("s59936640", "o1893", "c500212", 254.5, "quick-buy", "2022-05-13"),
        ("s59936641", "o1040", "c500137", 143.48, "alteration", "2022-05-07"),
        ("s59936642", "o1043", "c500355", 15.49, "cancellation", "2022-06-02"),
        ("s59936643", "o1232", "c500043", 47.05, "alteration", "2022-04-09"),
        ("s59936644", "o1072", "c500104", 35.27, "cancellation", "2022-05-31"),
        ("s59936645", "o1715", "c500314", 147.91, "quick-buy", "2022-05-22"),
        ("s59936646", "o1749", "c500259", 317.3, "alteration", "2022-04-20"),
        ("s59936647", "o1416", "c500138", 77.34, "buy", "2022-04-05"),
        ("s59936648", "o1815", "c500307", 8.12, "cancellation", "2022-05-27"),
        ("s59936649", "o1093", "c500392", 17.72, "cancellation", "2022-04-09"),
        ("s59936650", "o2168", "c500063", 247.56, "alteration", "2022-05-28"),
        ("s59936651", "o1189", "c500365", 50.5, "buy", "2022-04-27"),
        ("s59936652", "o1179", "c500233", 475.76, "alteration", "2022-05-19"),
        ("s59936653", "o1494", "c500380", 388.52, "buy", "2022-05-04"),
        ("s59936654", "o1837", "c500090", 368.84, "quick-buy", "2022-04-06"),
        ("s59936655", "o1932", "c500209", 270.58, "quick-buy", "2022-05-11"),
        ("s59936656", "o2047", "c500293", 176.54, "buy", "2022-05-02"),
        ("s59936657", "o1703", "c500318", 54.93, "buy", "2022-04-17"),
        ("s59936658", "o1440", "c500362", 491.93, "alteration", "2022-05-11"),
        ("s59936659", "o1463", "c500046", 72.26, "alteration", "2022-05-24"),
        ("s59936660", "o1372", "c500049", 370.62, "alteration", "2022-05-20"),
        ("s59936661", "o1660", "c500336", 130.56, "alteration", "2022-05-04"),
        ("s59936662", "o2088", "c500205", 475.35, "quick-buy", "2022-05-24"),
        ("s59936663", "o1786", "c500227", 412.3, "cancellation", "2022-04-25"),
        ("s59936664", "o1547", "c500216", 325.61, "buy", "2022-04-11"),
        ("s59936665", "o2103", "c500165", 134.99, "alteration", "2022-05-15"),
        ("s59936666", "o1768", "c500135", 155.81, "buy", "2022-05-06"),
        ("s59936667", "o1456", "c500216", 163.29, "buy", "2022-04-22"),
        ("s59936668", "o1279", "c500169", 362.26, "cancellation", "2022-05-31"),
        ("s59936669", "o1223", "c500081", 10.42, "buy", "2022-05-24"),
        ("s59936670", "o2105", "c500354", 490.49, "buy", "2022-05-25"),
        ("s59936671", "o1269", "c500251", 482.93, "cancellation", "2022-04-14"),
        ("s59936672", "o1985", "c500018", 109.66, "buy", "2022-05-12"),
        ("s59936673", "o1561", "c500270", 215.06, "buy", "2022-04-29"),
        ("s59936674", "o2000", "c500259", 372.19, "quick-buy", "2022-05-14"),
        ("s59936675", "o1148", "c500155", 38.83, "buy", "2022-05-13"),
        ("s59936676", "o2093", "c500254", 439.2, "buy", "2022-04-13"),
        ("s59936677", "o2174", "c500211", 334.56, "alteration", "2022-04-07"),
        ("s59936678", "o1161", "c500207", 291.02, "alteration", "2022-05-11"),
        ("s59936679", "o2122", "c500228", 293.06, "cancellation", "2022-05-10"),
        ("s59936680", "o1636", "c500310", 80.86, "alteration", "2022-04-17"),
        ("s59936681", "o1632", "c500204", 444.62, "cancellation", "2022-05-20"),
        ("s59936682", "o1576", "c500176", 215.98, "buy", "2022-04-14"),
        ("s59936683", "o1382", "c500054", 444.76, "buy", "2022-04-09"),
        ("s59936684", "o1497", "c500273", 384.7, "quick-buy", "2022-05-11"),
        ("s59936685", "o1421", "c500113", 334.11, "quick-buy", "2022-04-17"),
        ("s59936686", "o2182", "c500161", 392.18, "alteration", "2022-04-30"),
        ("s59936687", "o1840", "c500101", 435.4, "cancellation", "2022-05-30"),
        ("s59936688", "o2008", "c500000", 23.89, "buy", "2022-04-20"),
        ("s59936689", "o1601", "c500038", 347.18, "cancellation", "2022-05-25"),
        ("s59936690", "o1403", "c500227", 498.95, "buy", "2022-05-24"),
        ("s59936691", "o1461", "c500180", 127.94, "cancellation", "2022-04-06"),
        ("s59936692", "o1569", "c500144", 385.42, "buy", "2022-05-08"),
        ("s59936693", "o1967", "c500100", 366.07, "cancellation", "2022-05-30"),
        ("s59936694", "o2191", "c500080", 230.98, "cancellation", "2022-05-31"),
        ("s59936695", "o1641", "c500218", 198.99, "alteration", "2022-05-29"),
        ("s59936696", "o1075", "c500130", 487.29, "buy", "2022-05-09"),
        ("s59936697", "o1216", "c500095", 32.99, "cancellation", "2022-04-29"),
        ("s59936698", "o1616", "c500030", 179.02, "alteration", "2022-05-14"),
        ("s59936699", "o1948", "c500341", 192.25, "cancellation", "2022-05-27"),
        ("s59936700", "o1872", "c500106", 355.43, "buy", "2022-04-20"),
        ("s59936701", "o1786", "c500177", 434.46, "alteration", "2022-05-01"),
        ("s59936702", "o1797", "c500085", 252.89, "quick-buy", "2022-05-04"),
        ("s59936703", "o1917", "c500131", 81.86, "buy", "2022-05-24"),
        ("s59936704", "o1252", "c500123", 436.36, "quick-buy", "2022-05-26"),
        ("s59936705", "o1081", "c500006", 95.55, "cancellation", "2022-04-28"),
        ("s59936706", "o1914", "c500037", 244.04, "quick-buy", "2022-05-15"),
        ("s59936707", "o1596", "c500399", 25.06, "cancellation", "2022-05-24"),
        ("s59936708", "o1824", "c500340", 120.19, "quick-buy", "2022-06-02"),
        ("s59936709", "o1911", "c500134", 408.83, "alteration", "2022-05-24"),
        ("s59936710", "o1798", "c500004", 200.75, "quick-buy", "2022-04-08"),
        ("s59936711", "o1281", "c500041", 326.33, "quick-buy", "2022-05-17"),
        ("s59936712", "o1753", "c500004", 411.5, "quick-buy", "2022-05-16"),
        ("s59936713", "o1008", "c500031", 433.63, "buy", "2022-04-16"),
        ("s59936714", "o2115", "c500345", 352.87, "quick-buy", "2022-05-08"),
        ("s59936715", "o1704", "c500309", 288.42, "buy", "2022-04-20"),
        ("s59936716", "o1941", "c500393", 253.55, "buy", "2022-05-27"),
        ("s59936717", "o1189", "c500157", 16.23, "alteration", "2022-05-06"),
        ("s59936718", "o2067", "c500177", 483.89, "alteration", "2022-04-05"),
        ("s59936719", "o1205", "c500386", 390.27, "buy", "2022-05-29"),
        ("s59936720", "o1698", "c500212", 404.24, "alteration", "2022-05-02"),
        ("s59936721", "o1704", "c500095", 344.37, "buy", "2022-05-09"),
        ("s59936722", "o2051", "c500107", 371.56, "buy", "2022-05-28"),
        ("s59936723", "o1433", "c500264", 377.31, "cancellation", "2022-05-12"),
        ("s59936724", "o1062", "c500304", 19.45, "cancellation", "2022-05-16"),
        ("s59936725", "o1827", "c500066", 271.49, "quick-buy", "2022-04-12"),
        ("s59936726", "o1403", "c500038", 263.84, "cancellation", "2022-04-11"),
        ("s59936727", "o1784", "c500393", 431.55, "cancellation", "2022-05-01"),
        ("s59936728", "o1007", "c500331", 102.38, "buy", "2022-04-05"),
        ("s59936729", "o1081", "c500069", 376.58, "alteration", "2022-04-25"),
        ("s59936730", "o1415", "c500205", 255.04, "alteration", "2022-06-01"),
        ("s59936731", "o1553", "c500393", 146.51, "alteration", "2022-05-15"),
        ("s59936732", "o1349", "c500209", 379.22, "alteration", "2022-05-17"),
        ("s59936733", "o2165", "c500154", 214.22, "alteration", "2022-05-26"),
        ("s59936734", "o2112", "c500173", 372.12, "quick-buy", "2022-04-15"),
        ("s59936735", "o2011", "c500130", 66.07, "quick-buy", "2022-05-23"),
        ("s59936736", "o2025", "c500187", 369.18, "quick-buy", "2022-05-25"),
        ("s59936737", "o1984", "c500147", 122.17, "alteration", "2022-04-28"),
        ("s59936738", "o1695", "c500349", 264.34, "alteration", "2022-05-01"),
        ("s59936739", "o1985", "c500011", 486.15, "cancellation", "2022-05-13"),
        ("s59936740", "o1957", "c500108", 348.53, "quick-buy", "2022-05-10"),
        ("s59936741", "o1423", "c500349", 270.08, "cancellation", "2022-04-25"),
        ("s59936742", "o1804", "c500067", 488.85, "alteration", "2022-05-15"),
        ("s59936743", "o1499", "c500263", 179.32, "buy", "2022-04-20"),
        ("s59936744", "o1944", "c500035", 490.22, "cancellation", "2022-04-16"),
        ("s59936745", "o1611", "c500280", 107.41, "quick-buy", "2022-05-22"),
        ("s59936746", "o1818", "c500246", 167.54, "quick-buy", "2022-05-06"),
        ("s59936747", "o1597", "c500067", 419.82, "alteration", "2022-05-08"),
        ("s59936748", "o2179", "c500381", 357.39, "alteration", "2022-05-25"),
        ("s59936749", "o1845", "c500062", 412.24, "alteration", "2022-05-08"),
        ("s59936750", "o1958", "c500244", 430.35, "alteration", "2022-04-09"),
        ("s59936751", "o2035", "c500240", 329.21, "alteration", "2022-05-08"),
        ("s59936752", "o1141", "c500270", 200.59, "buy", "2022-04-27"),
        ("s59936753", "o1615", "c500082", 229.54, "quick-buy", "2022-06-01"),
        ("s59936754", "o1023", "c500215", 156.7, "alteration", "2022-04-10"),
        ("s59936755", "o1809", "c500176", 402.91, "cancellation", "2022-05-23"),
        ("s59936756", "o1562", "c500125", 154.77, "quick-buy", "2022-05-27"),
        ("s59936757", "o1180", "c500053", 232.87, "buy", "2022-06-02"),
        ("s59936758", "o1952", "c500009", 171.94, "cancellation", "2022-04-26"),
        ("s59936759", "o1706", "c500135", 242.74, "quick-buy", "2022-05-21"),
        ("s59936760", "o1317", "c500393", 283.48, "alteration", "2022-04-10"),
        ("s59936761", "o1377", "c500379", 177.86, "alteration", "2022-04-11"),
        ("s59936762", "o1179", "c500280", 396.69, "quick-buy", "2022-04-17"),
        ("s59936763", "o1472", "c500094", 337.61, "quick-buy", "2022-05-28"),
        ("s59936764", "o1588", "c500112", 208.67, "quick-buy", "2022-04-27"),
        ("s59936765", "o1143", "c500074", 238.31, "buy", "2022-05-02"),
        ("s59936766", "o1519", "c500098", 286.47, "buy", "2022-05-16"),
        ("s59936767", "o2180", "c500258", 171.84, "alteration", "2022-05-17"),
        ("s59936768", "o1158", "c500274", 110.27, "alteration", "2022-05-21"),
        ("s59936769", "o2034", "c500043", 472.27, "alteration", "2022-05-03"),
        ("s59936770", "o1094", "c500135", 205.59, "alteration", "2022-05-27"),
        ("s59936771", "o1994", "c500021", 249.53, "buy", "2022-05-04"),
        ("s59936772", "o1827", "c500035", 330.88, "cancellation", "2022-04-11"),
        ("s59936773", "o1382", "c500212", 340.19, "buy", "2022-04-21"),
        ("s59936774", "o1301", "c500053", 147.41, "quick-buy", "2022-05-13"),
        ("s59936775", "o2072", "c500352", 443.11, "buy", "2022-05-31"),
        ("s59936776", "o1168", "c500028", 20.75, "quick-buy", "2022-04-05"),
        ("s59936777", "o1145", "c500233", 400.97, "buy", "2022-04-09"),
        ("s59936778", "o2016", "c500000", 465.09, "buy", "2022-06-01"),
        ("s59936779", "o1143", "c500181", 310.12, "quick-buy", "2022-05-20"),
        ("s59936780", "o1754", "c500229", 269.58, "alteration", "2022-04-27"),
        ("s59936781", "o1590", "c500317", 53.55, "buy", "2022-04-26"),
        ("s59936782", "o1078", "c500216", 279.54, "buy", "2022-05-06"),
        ("s59936783", "o1196", "c500310", 164.62, "buy", "2022-05-15"),
        ("s59936784", "o2044", "c500159", 231.02, "alteration", "2022-05-08"),
        ("s59936785", "o1386", "c500328", 152.73, "buy", "2022-04-06"),
        ("s59936786", "o1858", "c500155", 112.94, "alteration", "2022-05-18"),
        ("s59936787", "o1126", "c500271", 477.16, "buy", "2022-04-25"),
        ("s59936788", "o1729", "c500159", 206.59, "alteration", "2022-05-23"),
        ("s59936789", "o1103", "c500002", 86.83, "cancellation", "2022-05-12"),
        ("s59936790", "o1551", "c500355", 18.53, "alteration", "2022-04-04"),
        ("s59936791", "o1221", "c500023", 126.95, "quick-buy", "2022-05-15"),
        ("s59936792", "o1620", "c500080", 455.28, "buy", "2022-05-24"),
        ("s59936793", "o1756", "c500256", 208.02, "quick-buy", "2022-04-29"),
        ("s59936794", "o1574", "c500194", 463.61, "cancellation", "2022-04-13"),
        ("s59936795", "o1577", "c500237", 150.09, "alteration", "2022-04-17"),
        ("s59936796", "o1741", "c500043", 209.94, "cancellation", "2022-04-24"),
        ("s59936797", "o1212", "c500228", 182.33, "quick-buy", "2022-04-07"),
        ("s59936798", "o1439", "c500242", 79.94, "quick-buy", "2022-05-09"),
        ("s59936799", "o1736", "c500073", 208.88, "alteration", "2022-04-20"),
        ("s59936800", "o1728", "c500061", 96.49, "alteration", "2022-05-01"),
        ("s59936801", "o1285", "c500098", 86.79, "alteration", "2022-05-18"),
        ("s59936802", "o1804", "c500363", 41.52, "cancellation", "2022-04-17"),
        ("s59936803", "o1222", "c500350", 339.99, "cancellation", "2022-05-25"),
        ("s59936804", "o1610", "c500106", 291.04, "buy", "2022-04-28"),
        ("s59936805", "o1333", "c500354", 69.33, "alteration", "2022-05-17"),
        ("s59936806", "o1176", "c500368", 456.47, "buy", "2022-04-21"),
        ("s59936807", "o1835", "c500307", 37.72, "quick-buy", "2022-05-26"),
        ("s59936808", "o1847", "c500134", 469.66, "quick-buy", "2022-04-30"),
        ("s59936809", "o1118", "c500288", 159.82, "cancellation", "2022-05-31"),
        ("s59936810", "o1814", "c500242", 355.57, "cancellation", "2022-05-30"),
        ("s59936811", "o1095", "c500249", 88.33, "cancellation", "2022-04-04"),
        ("s59936812", "o1859", "c500038", 364.66, "alteration", "2022-05-07"),
        ("s59936813", "o2063", "c500254", 121.15, "quick-buy", "2022-04-22"),
        ("s59936814", "o1975", "c500321", 26.36, "buy", "2022-05-30"),
        ("s59936815", "o2041", "c500202", 392.13, "alteration", "2022-05-18"),
        ("s59936816", "o1060", "c500380", 250.11, "alteration", "2022-04-24"),
        ("s59936817", "o1978", "c500271", 453.86, "quick-buy", "2022-05-18"),
        ("s59936818", "o1050", "c500118", 101.88, "quick-buy", "2022-04-30"),
        ("s59936819", "o1239", "c500333", 276.96, "cancellation", "2022-06-02"),
        ("s59936820", "o1127", "c500145", 28.42, "alteration", "2022-05-05"),
        ("s59936821", "o2061", "c500000", 410.77, "quick-buy", "2022-04-19"),
        ("s59936822", "o1333", "c500027", 419.6, "cancellation", "2022-04-19"),
        ("s59936823", "o1669", "c500239", 484.63, "cancellation", "2022-06-02"),
        ("s59936824", "o1391", "c500336", 213.2, "quick-buy", "2022-05-25"),
        ("s59936825", "o1482", "c500353", 404.89, "alteration", "2022-05-30"),
        ("s59936826", "o1541", "c500121", 450.81, "quick-buy", "2022-05-06"),
        ("s59936827", "o1188", "c500155", 375.85, "quick-buy", "2022-05-18"),
        ("s59936828", "o1955", "c500175", 182.6, "alteration", "2022-05-26"),
        ("s59936829", "o1199", "c500093", 448.74, "buy", "2022-05-28"),
        ("s59936830", "o1957", "c500368", 476.87, "buy", "2022-05-15"),
        ("s59936831", "o1448", "c500019", 244.58, "quick-buy", "2022-05-17"),
        ("s59936832", "o1048", "c500157", 290.22, "buy", "2022-04-24"),
        ("s59936833", "o2099", "c500397", 172.5, "cancellation", "2022-05-02"),
        ("s59936834", "o1258", "c500271", 142.88, "quick-buy", "2022-05-28"),
        ("s59936835", "o1555", "c500204", 33.65, "cancellation", "2022-05-03"),
        ("s59936836", "o1015", "c500295", 219.4, "alteration", "2022-04-06"),
        ("s59936837", "o1099", "c500155", 30.57, "cancellation", "2022-05-07"),
        ("s59936838", "o2167", "c500173", 430.78, "buy", "2022-05-02"),
        ("s59936839", "o1104", "c500124", 16.09, "cancellation", "2022-04-13"),
        ("s59936840", "o1246", "c500264", 304.36, "alteration", "2022-05-23"),
        ("s59936841", "o1235", "c500303", 291.93, "buy", "2022-04-05"),
        ("s59936842", "o1268", "c500294", 327.03, "quick-buy", "2022-04-22"),
        ("s59936843", "o2015", "c500334", 214.99, "quick-buy", "2022-04-06"),
        ("s59936844", "o1399", "c500016", 474.96, "buy", "2022-05-03"),
        ("s59936845", "o1711", "c500060", 259.87, "cancellation", "2022-05-11"),
        ("s59936846", "o2175", "c500301", 411.7, "buy", "2022-05-08"),
        ("s59936847", "o1124", "c500059", 109.07, "buy", "2022-05-28"),
        ("s59936848", "o1337", "c500305", 34.2, "cancellation", "2022-05-01"),
        ("s59936849", "o1232", "c500121", 29.27, "quick-buy", "2022-05-23"),
        ("s59936850", "o1796", "c500177", 93.3, "cancellation", "2022-05-20"),
        ("s59936851", "o2027", "c500220", 197.09, "cancellation", "2022-04-21"),
        ("s59936852", "o2058", "c500134", 455.82, "alteration", "2022-04-07"),
        ("s59936853", "o1259", "c500018", 471.76, "buy", "2022-05-22"),
        ("s59936854", "o2090", "c500023", 280.08, "quick-buy", "2022-04-21"),
        ("s59936855", "o1407", "c500284", 290.53, "buy", "2022-05-28"),
        ("s59936856", "o1703", "c500376", 315.87, "cancellation", "2022-04-04"),
        ("s59936857", "o1773", "c500143", 374.22, "alteration", "2022-04-18"),
        ("s59936858", "o1019", "c500099", 406.02, "alteration", "2022-05-12"),
        ("s59936859", "o1367", "c500098", 227.18, "alteration", "2022-05-28"),
        ("s59936860", "o1388", "c500076", 305.6, "cancellation", "2022-05-31"),
        ("s59936861", "o1194", "c500189", 270.46, "quick-buy", "2022-04-04"),
        ("s59936862", "o1436", "c500203", 485.34, "cancellation", "2022-05-26"),
        ("s59936863", "o1814", "c500066", 416.87, "quick-buy", "2022-05-05"),
        ("s59936864", "o1767", "c500318", 88.97, "alteration", "2022-04-08"),
        ("s59936865", "o1062", "c500219", 402.97, "alteration", "2022-05-07"),
        ("s59936866", "o1127", "c500113", 111.97, "cancellation", "2022-05-24"),
        ("s59936867", "o1419", "c500181", 460.75, "alteration", "2022-05-15"),
        ("s59936868", "o1873", "c500336", 231.09, "cancellation", "2022-05-19"),
        ("s59936869", "o1281", "c500129", 178.17, "cancellation", "2022-06-01"),
        ("s59936870", "o1853", "c500292", 310.47, "cancellation", "2022-04-19"),
        ("s59936871", "o1527", "c500161", 66.59, "alteration", "2022-04-08"),
        ("s59936872", "o1154", "c500231", 254.95, "cancellation", "2022-05-14"),
        ("s59936873", "o1286", "c500039", 123.32, "cancellation", "2022-05-03"),
        ("s59936874", "o1259", "c500035", 492.16, "buy", "2022-05-25"),
        ("s59936875", "o1308", "c500392", 289.62, "buy", "2022-04-08"),
        ("s59936876", "o1763", "c500182", 155.98, "alteration", "2022-04-29"),
        ("s59936877", "o1474", "c500073", 456.35, "quick-buy", "2022-04-24"),
        ("s59936878", "o1754", "c500242", 380.18, "cancellation", "2022-05-31"),
        ("s59936879", "o1627", "c500257", 106.87, "cancellation", "2022-04-30"),
        ("s59936880", "o1576", "c500248", 95.34, "cancellation", "2022-04-19"),
        ("s59936881", "o2132", "c500230", 267.16, "cancellation", "2022-05-15"),
        ("s59936882", "o1644", "c500081", 299.08, "quick-buy", "2022-04-08"),
        ("s59936883", "o1204", "c500215", 312.38, "alteration", "2022-05-03"),
        ("s59936884", "o2108", "c500116", 13.98, "buy", "2022-04-26"),
        ("s59936885", "o1098", "c500134", 259.25, "quick-buy", "2022-04-26"),
        ("s59936886", "o2007", "c500148", 98.92, "buy", "2022-05-04"),
        ("s59936887", "o1208", "c500386", 340.74, "alteration", "2022-05-18"),
        ("s59936888", "o1257", "c500073", 336.22, "quick-buy", "2022-04-09"),
        ("s59936889", "o1239", "c500210", 14.68, "quick-buy", "2022-04-21"),
        ("s59936890", "o1572", "c500141", 470.76, "cancellation", "2022-05-21"),
        ("s59936891", "o1492", "c500107", 413.63, "buy", "2022-05-22"),
        ("s59936892", "o1329", "c500266", 227.05, "quick-buy", "2022-05-31"),
        ("s59936893", "o1780", "c500027", 393.32, "quick-buy", "2022-04-29"),
        ("s59936894", "o1226", "c500125", 114.43, "cancellation", "2022-04-14"),
        ("s59936895", "o1630", "c500039", 375.88, "cancellation", "2022-04-21"),
        ("s59936896", "o1678", "c500155", 338.78, "quick-buy", "2022-05-31"),
        ("s59936897", "o1595", "c500056", 193.24, "cancellation", "2022-04-07"),
        ("s59936898", "o1725", "c500010", 215.91, "quick-buy", "2022-05-23"),
        ("s59936899", "o1141", "c500063", 412.15, "alteration", "2022-05-30"),
        ("s59936900", "o1439", "c500006", 57.99, "buy", "2022-05-23"),
        ("s59936901", "o1665", "c500002", 209.66, "alteration", "2022-04-17"),
        ("s59936902", "o1538", "c500225", 225.46, "cancellation", "2022-05-17"),
        ("s59936903", "o1427", "c500395", 89.41, "alteration", "2022-04-14"),
        ("s59936904", "o1065", "c500392", 284.71, "quick-buy", "2022-04-15"),
        ("s59936905", "o2140", "c500102", 312.54, "buy", "2022-05-29"),
        ("s59936906", "o1266", "c500270", 443.77, "quick-buy", "2022-05-02"),
        ("s59936907", "o1350", "c500191", 456.93, "buy", "2022-05-03"),
        ("s59936908", "o1093", "c500168", 65.6, "quick-buy", "2022-04-10"),
        ("s59936909", "o1160", "c500193", 70.84, "quick-buy", "2022-04-24"),
        ("s59936910", "o1592", "c500308", 106.77, "cancellation", "2022-05-01"),
        ("s59936911", "o1879", "c500385", 147.04, "buy", "2022-04-11"),
        ("s59936912", "o2189", "c500026", 44.04, "alteration", "2022-05-21"),
        ("s59936913", "o2168", "c500158", 196.6, "cancellation", "2022-05-21"),
        ("s59936914", "o2044", "c500354", 440.82, "alteration", "2022-05-05"),
        ("s59936915", "o1625", "c500275", 453.56, "quick-buy", "2022-05-19"),
        ("s59936916", "o1393", "c500146", 164.13, "quick-buy", "2022-05-05"),
        ("s59936917", "o1124", "c500066", 166.55, "buy", "2022-05-01"),
        ("s59936918", "o1903", "c500271", 447.76, "alteration", "2022-05-31"),
        ("s59936919", "o1558", "c500214", 188.37, "buy", "2022-05-16"),
        ("s59936920", "o1111", "c500050", 396.48, "quick-buy", "2022-04-08"),
        ("s59936921", "o1225", "c500244", 266.72, "buy", "2022-05-26"),
        ("s59936922", "o1314", "c500062", 55.2, "alteration", "2022-04-24"),
        ("s59936923", "o2150", "c500184", 402.56, "quick-buy", "2022-05-16"),
        ("s59936924", "o1413", "c500265", 257.76, "cancellation", "2022-05-12"),
        ("s59936925", "o1158", "c500172", 437.1, "quick-buy", "2022-04-14"),
        ("s59936926", "o1081", "c500342", 245.11, "cancellation", "2022-04-08"),
        ("s59936927", "o1663", "c500063", 334.44, "buy", "2022-06-01"),
        ("s59936928", "o1825", "c500358", 26.25, "buy", "2022-05-29"),
        ("s59936929", "o1676", "c500128", 98.39, "quick-buy", "2022-04-12"),
        ("s59936930", "o1501", "c500087", 468.64, "cancellation", "2022-04-17"),
        ("s59936931", "o1409", "c500317", 189.63, "cancellation", "2022-05-19"),
        ("s59936932", "o1575", "c500298", 149.39, "alteration", "2022-05-28"),
        ("s59936933", "o1123", "c500094", 51.65, "cancellation", "2022-05-17"),
        ("s59936934", "o1439", "c500050", 468.51, "alteration", "2022-04-09"),
        ("s59936935", "o1052", "c500188", 411.71, "alteration", "2022-05-24"),
        ("s59936936", "o1258", "c500382", 149.42, "cancellation", "2022-05-25"),
    ]

    customer_data = [
        ("c500278", "FR", "2022-05-29"),
        ("c500302", "CA", "2022-05-13"),
        ("c500372", "CA", "2022-05-02"),
        ("c500389", "CA", "2022-05-08"),
        ("c500039", "MX", "2022-05-30"),
        ("c500205", "MX", "2022-04-30"),
        ("c500394", "US", "2022-04-26"),
        ("c500091", "BR", "2022-05-22"),
        ("c500062", "US", "2022-04-07"),
        ("c500046", "MX", "2022-04-04"),
        ("c500291", "MX", "2022-04-09"),
        ("c500187", "BR", "2022-04-10"),
        ("c500147", "GR", "2022-04-05"),
        ("c500040", "CA", "2022-04-28"),
        ("c500218", "BR", "2022-05-11"),
        ("c500096", "MX", "2022-05-02"),
        ("c500157", "GR", "2022-04-23"),
        ("c500023", "US", "2022-05-07"),
        ("c500281", "GR", "2022-04-04"),
        ("c500283", "US", "2022-04-18"),
        ("c500288", "BR", "2022-04-10"),
        ("c500356", "BR", "2022-04-25"),
        ("c500296", "BR", "2022-05-28"),
        ("c500368", "BR", "2022-05-25"),
        ("c500306", "MX", "2022-04-26"),
        ("c500128", "GR", "2022-04-20"),
        ("c500029", "US", "2022-04-23"),
        ("c500050", "CA", "2022-04-11"),
        ("c500150", "CA", "2022-05-10"),
        ("c500086", "FR", "2022-05-30"),
        ("c500078", "US", "2022-04-07"),
        ("c500212", "CA", "2022-05-09"),
        ("c500094", "GR", "2022-05-28"),
        ("c500266", "FR", "2022-05-22"),
        ("c500366", "MX", "2022-05-04"),
        ("c500234", "BR", "2022-04-22"),
        ("c500247", "FR", "2022-04-05"),
        ("c500308", "BR", "2022-05-30"),
        ("c500119", "FR", "2022-04-24"),
        ("c500248", "CA", "2022-05-29"),
        ("c500243", "GR", "2022-05-17"),
        ("c500376", "BR", "2022-05-01"),
        ("c500056", "MX", "2022-04-26"),
        ("c500319", "GR", "2022-04-30"),
        ("c500333", "CA", "2022-04-07"),
        ("c500060", "US", "2022-05-09"),
        ("c500024", "MX", "2022-04-07"),
        ("c500303", "BR", "2022-04-04"),
        ("c500226", "GR", "2022-05-12"),
        ("c500005", "FR", "2022-05-14"),
        ("c500201", "CA", "2022-05-21"),
        ("c500377", "CA", "2022-05-15"),
        ("c500003", "FR", "2022-05-12"),
        ("c500260", "BR", "2022-05-14"),
        ("c500118", "BR", "2022-05-14"),
        ("c500253", "BR", "2022-05-15"),
        ("c500162", "MX", "2022-05-04"),
        ("c500174", "CA", "2022-05-07"),
        ("c500275", "US", "2022-05-11"),
        ("c500351", "BR", "2022-05-09"),
        ("c500304", "FR", "2022-04-20"),
        ("c500122", "CA", "2022-04-26"),
        ("c500064", "GR", "2022-04-05"),
        ("c500022", "CA", "2022-05-23"),
        ("c500375", "BR", "2022-05-12"),
        ("c500274", "GR", "2022-05-23"),
        ("c500251", "US", "2022-05-15"),
        ("c500090", "GR", "2022-05-02"),
        ("c500170", "BR", "2022-05-29"),
        ("c500200", "CA", "2022-05-11"),
        ("c500034", "FR", "2022-05-18"),
        ("c500019", "US", "2022-04-19"),
        ("c500139", "US", "2022-04-17"),
        ("c500014", "CA", "2022-05-23"),
        ("c500106", "GR", "2022-04-19"),
        ("c500083", "CA", "2022-05-10"),
        ("c500284", "CA", "2022-04-29"),
        ("c500140", "CA", "2022-05-29"),
        ("c500058", "US", "2022-04-14"),
        ("c500026", "MX", "2022-05-14"),
        ("c500052", "CA", "2022-05-09"),
        ("c500035", "FR", "2022-05-22"),
        ("c500334", "US", "2022-04-09"),
        ("c500328", "BR", "2022-05-26"),
        ("c500323", "GR", "2022-04-12"),
        ("c500054", "CA", "2022-05-12"),
        ("c500330", "GR", "2022-04-28"),
        ("c500044", "GR", "2022-05-14"),
        ("c500325", "GR", "2022-05-02"),
        ("c500268", "BR", "2022-05-16"),
        ("c500059", "US", "2022-05-30"),
        ("c500343", "CA", "2022-05-10"),
        ("c500116", "MX", "2022-04-27"),
        ("c500227", "CA", "2022-04-16"),
        ("c500063", "FR", "2022-06-01"),
        ("c500335", "BR", "2022-04-06"),
        ("c500001", "BR", "2022-05-03"),
        ("c500317", "BR", "2022-05-12"),
        ("c500357", "FR", "2022-04-29"),
        ("c500079", "GR", "2022-05-20"),
        ("c500380", "CA", "2022-05-15"),
        ("c500191", "CA", "2022-05-26"),
        ("c500143", "BR", "2022-04-30"),
        ("c500055", "GR", "2022-04-28"),
        ("c500360", "FR", "2022-05-09"),
        ("c500287", "US", "2022-04-26"),
        ("c500188", "GR", "2022-04-14"),
        ("c500109", "GR", "2022-05-11"),
        ("c500352", "CA", "2022-04-05"),
        ("c500126", "CA", "2022-05-28"),
        ("c500073", "MX", "2022-04-21"),
        ("c500008", "US", "2022-05-26"),
        ("c500257", "CA", "2022-04-15"),
        ("c500193", "CA", "2022-04-17"),
        ("c500176", "GR", "2022-04-06"),
        ("c500067", "MX", "2022-05-19"),
        ("c500108", "GR", "2022-05-18"),
        ("c500199", "US", "2022-04-15"),
        ("c500208", "BR", "2022-04-16"),
        ("c500142", "CA", "2022-04-09"),
        ("c500273", "BR", "2022-04-16"),
        ("c500088", "CA", "2022-04-09"),
        ("c500339", "GR", "2022-05-18"),
        ("c500033", "CA", "2022-05-23"),
        ("c500340", "FR", "2022-05-01"),
        ("c500159", "BR", "2022-05-30"),
        ("c500222", "CA", "2022-06-02"),
        ("c500316", "GR", "2022-05-25"),
        ("c500010", "FR", "2022-04-20"),
        ("c500000", "FR", "2022-05-27"),
        ("c500051", "BR", "2022-05-28"),
        ("c500004", "BR", "2022-05-18"),
        ("c500276", "MX", "2022-05-01"),
        ("c500367", "FR", "2022-05-24"),
        ("c500241", "GR", "2022-05-30"),
        ("c500137", "US", "2022-04-25"),
        ("c500387", "GR", "2022-05-10"),
        ("c500285", "CA", "2022-04-11"),
        ("c500229", "MX", "2022-05-25"),
        ("c500061", "FR", "2022-05-22"),
        ("c500020", "FR", "2022-04-16"),
        ("c500146", "MX", "2022-05-09"),
        ("c500045", "MX", "2022-06-01"),
        ("c500021", "MX", "2022-05-15"),
        ("c500168", "BR", "2022-05-18"),
        ("c500089", "GR", "2022-05-20"),
        ("c500173", "BR", "2022-04-16"),
        ("c500277", "FR", "2022-04-09"),
        ("c500030", "BR", "2022-04-07"),
        ("c500297", "GR", "2022-04-10"),
        ("c500120", "US", "2022-04-07"),
        ("c500171", "FR", "2022-05-29"),
        ("c500114", "US", "2022-05-23"),
        ("c500363", "FR", "2022-05-08"),
        ("c500362", "FR", "2022-04-26"),
        ("c500383", "US", "2022-04-29"),
        ("c500131", "CA", "2022-04-25"),
        ("c500006", "BR", "2022-05-09"),
        ("c500361", "CA", "2022-05-21"),
        ("c500017", "BR", "2022-04-18"),
        ("c500113", "MX", "2022-04-05"),
        ("c500037", "BR", "2022-04-22"),
        ("c500181", "CA", "2022-04-25"),
        ("c500182", "MX", "2022-04-20"),
        ("c500204", "GR", "2022-04-24"),
        ("c500013", "US", "2022-04-14"),
        ("c500068", "GR", "2022-05-31"),
        ("c500265", "CA", "2022-05-16"),
        ("c500209", "GR", "2022-05-12"),
        ("c500153", "GR", "2022-05-21"),
        ("c500353", "FR", "2022-05-11"),
        ("c500395", "US", "2022-05-15"),
        ("c500002", "MX", "2022-05-09"),
        ("c500215", "MX", "2022-04-05"),
        ("c500219", "FR", "2022-05-19"),
        ("c500194", "FR", "2022-05-16"),
        ("c500271", "CA", "2022-05-20"),
        ("c500214", "FR", "2022-05-06"),
        ("c500397", "MX", "2022-05-23"),
        ("c500081", "FR", "2022-04-07"),
        ("c500332", "US", "2022-04-13"),
        ("c500329", "US", "2022-05-30"),
        ("c500189", "BR", "2022-05-18"),
        ("c500148", "BR", "2022-04-19"),
        ("c500286", "US", "2022-05-02"),
        ("c500134", "US", "2022-05-09"),
        ("c500115", "US", "2022-05-03"),
        ("c500232", "BR", "2022-04-16"),
        ("c500156", "FR", "2022-04-20"),
        ("c500065", "FR", "2022-04-08"),
        ("c500364", "BR", "2022-05-06"),
        ("c500009", "BR", "2022-05-02"),
        ("c500184", "FR", "2022-04-06"),
        ("c500085", "US", "2022-05-07"),
        ("c500104", "CA", "2022-04-29"),
        ("c500164", "BR", "2022-04-22"),
        ("c500038", "BR", "2022-04-28"),
        ("c500102", "CA", "2022-04-08"),
        ("c500270", "BR", "2022-05-06"),
        ("c500272", "CA", "2022-04-13"),
        ("c500100", "BR", "2022-05-21"),
        ("c500320", "MX", "2022-04-11"),
        ("c500338", "BR", "2022-05-28"),
        ("c500224", "CA", "2022-05-03"),
        ("c500315", "FR", "2022-04-20"),
        ("c500011", "CA", "2022-05-14"),
        ("c500145", "US", "2022-04-20"),
        ("c500076", "GR", "2022-04-13"),
        ("c500258", "MX", "2022-04-15"),
        ("c500080", "BR", "2022-05-15"),
        ("c500057", "BR", "2022-04-25"),
        ("c500077", "GR", "2022-04-10"),
        ("c500269", "GR", "2022-05-20"),
        ("c500294", "FR", "2022-04-07"),
        ("c500167", "BR", "2022-05-22"),
        ("c500310", "FR", "2022-05-24"),
        ("c500101", "GR", "2022-05-16"),
        ("c500070", "US", "2022-05-07"),
        ("c500350", "FR", "2022-05-16"),
        ("c500018", "CA", "2022-04-07"),
        ("c500373", "FR", "2022-04-05"),
        ("c500132", "BR", "2022-05-29"),
        ("c500178", "GR", "2022-04-10"),
        ("c500211", "MX", "2022-04-19"),
        ("c500256", "US", "2022-04-16"),
        ("c500165", "GR", "2022-04-06"),
        ("c500261", "GR", "2022-05-24"),
        ("c500295", "FR", "2022-05-19"),
        ("c500252", "FR", "2022-04-11"),
        ("c500249", "GR", "2022-04-29"),
        ("c500390", "GR", "2022-04-12"),
        ("c500190", "MX", "2022-04-20"),
        ("c500293", "FR", "2022-04-11"),
        ("c500127", "US", "2022-04-26"),
        ("c500359", "US", "2022-05-30"),
        ("c500371", "FR", "2022-04-30"),
        ("c500161", "FR", "2022-04-13"),
        ("c500299", "US", "2022-04-25"),
        ("c500166", "BR", "2022-04-29"),
        ("c500084", "MX", "2022-04-09"),
        ("c500267", "GR", "2022-05-17"),
        ("c500245", "MX", "2022-05-03"),
        ("c500202", "CA", "2022-04-24"),
        ("c500107", "GR", "2022-06-02"),
        ("c500228", "US", "2022-05-14"),
        ("c500213", "FR", "2022-04-05"),
        ("c500071", "MX", "2022-04-05"),
        ("c500195", "MX", "2022-04-06"),
        ("c500092", "FR", "2022-05-25"),
        ("c500207", "US", "2022-05-05"),
        ("c500216", "MX", "2022-04-28"),
        ("c500240", "MX", "2022-05-11"),
        ("c500048", "US", "2022-05-04"),
        ("c500053", "US", "2022-04-14"),
        ("c500172", "BR", "2022-04-24"),
        ("c500344", "MX", "2022-04-16"),
        ("c500141", "MX", "2022-05-02"),
        ("c500138", "CA", "2022-04-15"),
        ("c500111", "US", "2022-04-30"),
        ("c500385", "MX", "2022-05-25"),
        ("c500349", "BR", "2022-05-20"),
        ("c500217", "MX", "2022-04-27"),
        ("c500097", "FR", "2022-04-14"),
        ("c500314", "MX", "2022-05-01"),
        ("c500259", "BR", "2022-04-29"),
        ("c500123", "FR", "2022-04-11"),
        ("c500032", "US", "2022-05-20"),
        ("c500233", "MX", "2022-05-17"),
        ("c500391", "US", "2022-05-10"),
        ("c500337", "MX", "2022-04-12"),
        ("c500112", "CA", "2022-05-30"),
        ("c500280", "BR", "2022-04-09"),
        ("c500031", "FR", "2022-05-04"),
        ("c500186", "CA", "2022-05-12"),
        ("c500043", "US", "2022-04-27"),
        ("c500355", "CA", "2022-04-14"),
        ("c500036", "GR", "2022-04-30"),
        ("c500177", "FR", "2022-04-18"),
        ("c500321", "MX", "2022-05-25"),
        ("c500392", "CA", "2022-05-27"),
        ("c500223", "FR", "2022-05-29"),
        ("c500230", "MX", "2022-04-15"),
        ("c500326", "CA", "2022-05-03"),
        ("c500393", "CA", "2022-05-01"),
        ("c500254", "US", "2022-04-21"),
    ]
    return {
        CUSTOMERS_TABLE: make_df(
            sql_client=sql_client, columns=["id_customer", "country", "ds"], time_columns={"ds"}, data=customer_data
        ),
        TRANSACTIONS_TABLE: make_df(
            sql_client=sql_client,
            columns=[
                "id_transaction",
                "id_order",
                "id_customer",
                "transaction_amount_usd",
                "transaction_type_name",
                "ds",
            ],
            time_columns={"ds"},
            data=transaction_data,
        ),
        COUNTRIES_TABLE: make_df(sql_client=sql_client, columns=["country", "region"], data=COUNTRIES),
    }


def create_sample_data(sql_client: SqlClient, system_schema: str) -> bool:
    """Create tables with sample data into data warehouse."""

    if any(
        [
            sql_client.table_exists(SqlTable.from_string(f"{system_schema}.{CUSTOMERS_TABLE}")),
            sql_client.table_exists(SqlTable.from_string(f"{system_schema}.{TRANSACTIONS_TABLE}")),
            sql_client.table_exists(SqlTable.from_string(f"{system_schema}.{COUNTRIES_TABLE}")),
        ]
    ):
        # Do not create sample data if any of the table exists
        return False

    dummy_data = build_dataframe(sql_client)
    for table_name in dummy_data:
        sql_table = SqlTable.from_string(f"{system_schema}.{table_name}")
        sql_client.create_table_from_dataframe(sql_table=sql_table, df=dummy_data[table_name])
    return True


def remove_sample_tables(sql_client: SqlClient, system_schema: str) -> None:
    """Drop sample tables."""
    sql_client.drop_table(SqlTable.from_string(f"{system_schema}.{CUSTOMERS_TABLE}"))
    sql_client.drop_table(SqlTable.from_string(f"{system_schema}.{TRANSACTIONS_TABLE}"))
    sql_client.drop_table(SqlTable.from_string(f"{system_schema}.{COUNTRIES_TABLE}"))


def gen_sample_model_configs(dir_path: str, system_schema: str) -> None:
    """Generates the sample model configs to a specified directory."""

    with open(CUSTOMERS_YAML_FILE) as f:
        contents = Template(f.read()).substitute({"customers_table": f"{system_schema}.{CUSTOMERS_TABLE}"})
    with open(f"{dir_path}/{CUSTOMERS_TABLE}.yaml", "w") as file:
        file.write(contents)

    with open(TRANSACTIONS_YAML_FILE) as f:
        contents = Template(f.read()).substitute({"transactions_table": f"{system_schema}.{TRANSACTIONS_TABLE}"})
    with open(f"{dir_path}/{TRANSACTIONS_TABLE}.yaml", "w") as file:
        file.write(contents)

    with open(COUNTRIES_YAML_FILE) as f:
        contents = Template(f.read()).substitute({"countries_table": f"{system_schema}.{COUNTRIES_TABLE}"})
    with open(f"{dir_path}/{COUNTRIES_TABLE}.yaml", "w") as file:
        file.write(contents)
